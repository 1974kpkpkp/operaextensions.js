// operaextensions_background.min.js - http://github.com/operasoftware/operaextensions.js
'use strict';!function(l){function K(a,d,b){z?a[d].apply(a,b):x.push({target:a,methodName:d,args:b})}function F(a,d){function b(a,b,d){0>d&&(d+=1);1<d&&(d-=1);return d<1/6?a+6*(b-a)*d:0.5>d?b:d<2/3?a+6*(b-a)*(2/3-d):a}function c(a){a=parseInt(a,10);a=a.toString(16);return 0==a?"00":a}if(void 0===a||null===a)return a;var a=a+"",e={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,
235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,
50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,
128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,
160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,
21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,
230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,
130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}[a.toLowerCase()];if(e)return"#"+c(e[0])+c(e[1])+c(e[2]);var e={hexLong:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hexShort:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/},f;for(f in e)if(a.match(e[f]))return a;f=[["rgb",/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/],["rgb",/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d+(?:\.\d+)?|\.\d+)\s*\)$/],["hsl",/^hsl\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/],
["hsl",/^hsla\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%,\s*(\d+(?:\.\d+)?|\.\d+)\s*\)$/],["hsv",/^hsv\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/]];for(var e={rgb:function(a){return[a[1],a[2],a[3],a[4]||1]},hsl:function(a){var d=parseInt(a[1],10)%360/360,c=parseInt(a[2],10)%101/100,e=parseInt(a[3],10)%101/100,a=a[4]||1;if(0===c)return[e,e,e];c=0.5>e?e*(1+c):e+c-e*c;e=2*e-c;return[(256*b(e,c,d+1/3)).toFixed(0),(256*b(e,c,d)).toFixed(0),(256*b(e,c,d-1/3)).toFixed(0),a]},hsv:function(a){var d,b,c,e=parseInt(a[1],
10)%360/360,f=parseInt(a[2],10)%101/100,a=parseInt(a[3],10)%101/100,i=Math.floor(6*e),G=6*e-i,e=a*(1-f),g=a*(1-G*f),f=a*(1-(1-G)*f);switch(i%6){case 0:d=a;b=f;c=e;break;case 1:d=g;b=a;c=e;break;case 2:d=e;b=a;c=f;break;case 3:d=e;b=g;c=a;break;case 4:d=f;b=e;c=a;break;case 5:d=a,b=e,c=g}return[256*d,256*b,256*c]}},i=0,G=f.length;i<G;i++){var g=f[i][1].exec(a);if(g)return f=e[f[i][0]](g),e=parseFloat(f[3]||1),f="NaN"===e+""||0>e||1<=e?f:0==e?[255,255,255]:[e*parseInt(f[0],10)+(1-e)*(d||255),e*parseInt(f[1],
10)+(1-e)*(d||255),e*parseInt(f[2],10)+(1-e)*(d||255)],"#"+c(f[0]||255)+c(f[1]||255)+c(f[2]||255)}return"#f00"}function p(a,d,b){Error.call(this);Error.captureStackTrace(this,arguments.callee);this.name=a||"Error";this.code=b||-1;this.message=d||""}var k=function(){};k.prototype.REVISION="1";k.prototype.version=function(){return this.REVISION};k.prototype.buildNumber=function(){return this.REVISION};k.prototype.postError=function(a){console.log(a)};var u=l.opera||new k,z=!1,x=[],D={WINTABS_LOADED:!1,
WIDGET_API_LOADED:!1,WIDGET_PREFERENCES_LOADED:!1},A={},k="undefined"!==typeof window?window:{},k=k.MutationObserver||k.WebKitMutationObserver;if("undefined"!==typeof process&&"[object process]"==={}.toString.call(process))k=function(a,d){process.nextTick(function(){a.call(d)})};else if(k){var L=[],k=new k(function(){var a=L.slice();L=[];a.forEach(function(a){a[0].call(a[1])})}),O=document.createElement("div");k.observe(O,{attributes:!0});k=function(a,d){L.push([a,d]);O.setAttribute("drainQueue",
"drainQueue")}}else k=function(a,d){setTimeout(function(){a.call(d)},1)};A.async=k;var X=A.Event=function(a,d){this.type=a;for(var b in d)d.hasOwnProperty(b)&&(this[b]=d[b])},P=function(a,d){for(var b=0,c=a.length;b<c;b++)if(a[b][0]===d)return b;return-1},M=function(a){var d=a._promiseCallbacks;d||(d=a._promiseCallbacks={});return d},B=A.EventTarget={mixin:function(a){a.on=this.on;a.off=this.off;a.trigger=this.trigger;return a},on:function(a,d,b){for(var c=M(this),e,f,a=a.split(/\s+/),b=b||this;f=
a.shift();)(e=c[f])||(e=c[f]=[]),-1===P(e,d)&&e.push([d,b])},off:function(a,d){for(var b=M(this),c,e,a=a.split(/\s+/);c=a.shift();)d?(c=b[c],e=P(c,d),-1!==e&&c.splice(e,1)):b[c]=[]},trigger:function(a,d){var b,c,e,f;if(b=M(this)[a])for(var i=0,g=b.length;i<g;i++)c=b[i],e=c[0],c=c[1],"object"!==typeof d&&(d={detail:d}),f=new X(a,d),e.call(c,f)}},C=A.Promise=function(){this.on("promise:resolved",function(a){this.trigger("success",{detail:a.detail})},this);this.on("promise:failed",function(a){this.trigger("error",
{detail:a.detail})},this)},Q=function(){},R=function(a,d,b,c){var e,f;if(b)try{e=b(c.detail)}catch(i){f=i}else e=c.detail;if(e instanceof C)e.then(function(a){d.resolve(a)},function(a){d.reject(a)});else if(b&&e)d.resolve(e);else if(f)d.reject(f);else d[a](e)};C.prototype={then:function(a,d){var b=new C;this.on("promise:resolved",function(d){R("resolve",b,a,d)});this.on("promise:failed",function(a){R("reject",b,d,a)});return b},resolve:function(a){A.async(function(){this.trigger("promise:resolved",
{detail:a});this.isResolved=a},this);this.reject=this.resolve=Q},reject:function(a){A.async(function(){this.trigger("promise:failed",{detail:a});this.isRejected=a},this);this.reject=this.resolve=Q}};B.mixin(C.prototype);p.prototype.__proto__=Error.prototype;var j=function(a,d){var b=document.createEvent("Event");b.initEvent(a,!0,!0);for(var c in d)b[c]=d[c];return b},k=function(){B.mixin(this)};k.prototype.constructor=k;k.prototype.addEventListener=function(a,d){this.on(a,d)};k.prototype.removeEventListener=
function(a,d){this.off(a,d)};k.prototype.dispatchEvent=function(a){var d=a.type;if("function"===typeof this["on"+d.toLowerCase()])this.on(d,this["on"+d.toLowerCase()]);this.trigger(d,a)};var n=function(){C.call(this);this._queue=[];this.on("promise:resolved",function(){this.dequeue()}.bind(this))};n.prototype=Object.create(C.prototype);for(var o in k.prototype)n.prototype[o]=k.prototype[o];n.prototype.enqueue=function(){if(!(1>arguments.length)){var a=arguments[0],d=[];if(1<arguments.length)for(var b=
1,c=arguments.length;b<c;b++)d.push(arguments[b]);this.isResolved?a.apply(this,d):this._queue.push({action:a,args:d})}};n.prototype.dequeue=function(){var a=this._queue[0];a&&(this._queue.splice(0,1),a.action&&a.action.apply(this,a.args))};var H=function(a){B.mixin(this);this._isBackground=a||!1;this._localPort=null;this._isBackground||(this._localPort=chrome.extension.connect({name:""+Math.floor(1E16*Math.random())}),this._localPort.onDisconnect.addListener(function(){this.dispatchEvent(new j("disconnect",
{source:this._localPort}));this._localPort=null}.bind(this)),this._localPort.onMessage.addListener(function(a,b){var c=this._localPort;a&&a.action&&0===a.action.indexOf("___O_")?this.dispatchEvent(new j("controlmessage",{data:a,source:{postMessage:function(a){c.postMessage(a)},tabId:b&&b.tab?b.tab.id:null}})):K(this,"dispatchEvent",[new j("message",{data:a,source:{postMessage:function(a){c.postMessage(a)},tabId:b&&b.tab?b.tab.id:null}})])}.bind(this)),K(this,"dispatchEvent",[new j("connect",{source:this._localPort})]))};
H.prototype=Object.create(k.prototype);H.prototype.postMessage=function(a){this._isBackground?this.broadcastMessage(a):this._localPort&&this._localPort.postMessage(a)};var I=function(){H.call(this,!0);this._allPorts=[];chrome.extension.onConnect.addListener(function(a){var d=this._allPorts.length;a.onDisconnect.addListener(function(){this._allPorts.splice(d-1,1);this.dispatchEvent(new j("disconnect",{source:a}))}.bind(this));this._allPorts[d]=a;a.onMessage.addListener(function(b){b&&b.action&&0===
b.action.indexOf("___O_")?this.dispatchEvent(new j("controlmessage",{data:b,source:{postMessage:function(b){a.postMessage(b)},tabId:a.sender&&a.sender.tab?a.sender.tab.id:null}})):K(this,"dispatchEvent",[new j("message",{data:b,source:{postMessage:function(b){a.postMessage(b)},tabId:a.sender&&a.sender.tab?a.sender.tab.id:null}})])}.bind(this));this.dispatchEvent(new j("connect",{source:a}))}.bind(this))};I.prototype=Object.create(H.prototype);I.prototype.broadcastMessage=function(a){for(var d=0,b=
this._allPorts.length;d<b;d++)this._allPorts[d].postMessage(a)};var m=function(){I.call(this)};m.prototype=Object.create(I.prototype);var g=u.extension=u.extension||new m,S=u.contexts=u.contexts||{};m.prototype.getFile=function(a){var d=null;if("string"!=typeof a)return d;try{var b=chrome.extension.getURL("");0==a.indexOf("widget:")&&(a=a.replace("widget:","chrome-extension:"));0==a.indexOf("/")&&(a=a.substring(1));var a=(-1==a.indexOf(b)?b:"")+a,c=new XMLHttpRequest;c.onloadend=function(){c.readyState==
c.DONE&&200==c.status&&(result=c.response,result.name=a.substring(a.lastIndexOf("/")+1),result.lastModifiedDate=null,result.toString=function(){return"[object File]"},d=result)};c.open("GET",a,!1);c.responseType="blob";c.send(null)}catch(e){}return d};var y=function(){Object.defineProperty(this,"_storage",{value:localStorage});Object.defineProperty(this,"length",{value:0,writable:!0});for(var a in localStorage)this[a]=localStorage[a],this.length++;Object.defineProperty(y.prototype,"getItem",{value:function(a){return this._storage.getItem(a)}.bind(this)});
Object.defineProperty(y.prototype,"key",{value:function(a){return this._storage.key(a)}.bind(this)});Object.defineProperty(y.prototype,"removeItem",{value:function(a,b){this._storage.removeItem(a);this.hasOwnProperty(a)&&(delete this[a],this.length--);b||g.postMessage({action:"___O_widgetPreferences_removeItem_RESPONSE",data:{key:a}})}.bind(this)});Object.defineProperty(y.prototype,"setItem",{value:function(a,b,c){var e=this._storage.getItem(a);this._storage.setItem(a,b);this[a]||this.length++;this[a]=
b;c||g.postMessage({action:"___O_widgetPreferences_setItem_RESPONSE",data:{key:a,val:b}});a=new j("storage",{key:a,oldValue:e,newValue:this._storage.getItem(a),url:chrome.extension.getURL(""),storageArea:this._storage});l.dispatchEvent(a)}.bind(this)});Object.defineProperty(y.prototype,"clear",{value:function(a){this._storage.clear();for(var b in this)this.hasOwnProperty(b)&&delete this[b];this.length=0;a||g.postMessage({action:"___O_widgetPreferences_clearItem_RESPONSE"})}.bind(this)})};y.prototype=
Object.create(Storage.prototype);m=function(){B.mixin(this);this.properties={};this._preferences=new y;D.WIDGET_PREFERENCES_LOADED=!0;var a=new XMLHttpRequest;a.open("GET","/manifest.json",!0);a.onreadystatechange=function(){4==a.readyState&&(this.properties=JSON.parse(a.responseText),this.properties.id=/^chrome\-extension\:\/\/(.*)\/$/.exec(chrome.extension.getURL(""))[1],D.WIDGET_API_LOADED=!0)}.bind(this);a.send();g.addEventListener("controlmessage",function(a){if(a.data&&a.data.action)switch(a.data.action){case "___O_widget_setup_REQUEST":var b=
{},c;for(c in this.properties)b[c]=this.properties[c];a.source.postMessage({action:"___O_widget_setup_RESPONSE",attrs:b,_prefs:this._preferences});break;case "___O_widgetPreferences_setItem_REQUEST":this._preferences.setItem(a.data.data.key,a.data.data.val,!0);break;case "___O_widgetPreferences_removeItem_REQUEST":this._preferences.removeItem(a.data.data.key,!0);break;case "___O_widgetPreferences_clear_REQUEST":this._preferences.clear(!0)}}.bind(this),!1)};m.prototype=Object.create(k.prototype);m.prototype.__defineGetter__("name",
function(){return this.properties.name||""});m.prototype.__defineGetter__("shortName",function(){return this.properties.name?this.properties.name.short||"":""});m.prototype.__defineGetter__("id",function(){return this.properties.id||""});m.prototype.__defineGetter__("description",function(){return this.properties.description||""});m.prototype.__defineGetter__("author",function(){return this.properties.author?this.properties.author.name||"":""});m.prototype.__defineGetter__("authorHref",function(){return this.properties.author?
this.properties.author.href||"":""});m.prototype.__defineGetter__("authorEmail",function(){return this.properties.author?this.properties.author.email||"":""});m.prototype.__defineGetter__("version",function(){return this.properties.version||""});m.prototype.__defineGetter__("preferences",function(){return this._preferences});l.widget=l.widget||new m;m=function(){n.call(this);this.length=0;this._focusedWin=null;this.__defineGetter__("_lastFocusedWindow",function(){return this._focusedWin});this.__defineSetter__("_lastFocusedWindow",
function(a){this._focusedWin=a});chrome.windows.getAll({populate:!0},function(a){for(var d=[],b=0,c=a.length;b<c;b++){this[b]=new q(a[b]);this.length=b+1;null===this._lastFocusedWindow&&(this._lastFocusedWindow=this[b]);!0==this[b].properties.focused&&(this._lastFocusedWindow=this[b]);for(var e=[],f=0,i=a[b].tabs.length;f<i;f++)e[f]=new h(a[b].tabs[f],this[b],!0);this[b].tabs.replaceTabs(e);d=d.concat(e)}g.tabs.replaceTabs(d);this.resolve(!0);g.tabs.resolve(!0);b=0;for(c=this.length;b<c;b++){this[b].resolve(!0);
this[b].tabs.resolve(!0);f=0;for(i=this[b].tabs.length;f<i;f++)this[b].tabs[f].resolve(!0)}D.WINTABS_LOADED=!0}.bind(this));chrome.windows.onCreated.addListener(function(a){l.setTimeout(function(){for(var d=!1,b=0,c=this.length;b<c;b++)if(this[b].properties.id==a.id){d=!0;!0==this[b].properties.focused&&(this._lastFocusedWindow=this[b]);break}if(!d){d=new q(a);c=[];for(b in a.tabs){var e=new h(a.tabs[b],d);e.properties.active&&(this._lastFocusedWindow=d);c.push(e)}d.tabs.replaceTabs(c);this[this.length]=
d;this.length+=1;d.focused&&(this._lastFocusedWindow=d);d.resolve(!0);d.tabs.resolve(!0);b=0;for(c=d.tabs.length;b<c;b++)d.tabs[b].resolve(!0);this.dispatchEvent(new j("create",{browserWindow:d}))}}.bind(this),200)}.bind(this));chrome.windows.onFocusChanged.addListener(function(a){var d=this._lastFocusedWindow;if(a!==chrome.windows.WINDOW_ID_NONE)for(var b=0,c=this.length;b<c;b++)if(this[b].properties.id==a&&this._lastFocusedWindow!==this[b]){this[b].properties.focused=!0;this._lastFocusedWindow=
this[b];b=0;for(c=this._lastFocusedWindow.tabs.length;b<c;b++)if(!0==this._lastFocusedWindow.tabs[b].properties.active){this._lastFocusedWindow.tabs._lastFocusedTab=this._lastFocusedWindow.tabs[b];g.tabs._lastFocusedTab=this._lastFocusedWindow.tabs[b];break}break}b=0;for(c=this.length;b<c;b++)if(this[b].properties.id!==a&&this[b]==d){this[b].properties.focused=!1;this[b].dispatchEvent(new j("blur",{browserWindow:this._lastFocusedWindow}));this.dispatchEvent(new j("blur",{browserWindow:this._lastFocusedWindow}));
this._lastFocusedWindow.dispatchEvent(new j("focus",{browserWindow:d}));this.dispatchEvent(new j("focus",{browserWindow:d}));break}}.bind(this));chrome.windows.onRemoved.addListener(function(a){for(var d=-1,b=0,c=this.length;b<c;b++)if(this[b].properties.id==a){d=b;break}if(-1<d){this[d].properties.closed=!0;this.dispatchEvent(new j("close",{browserWindow:this[d]}));b=d;for(c=this.length;b<c;b++)this[b+1]?this[b]=this[b+1]:delete this[b];this.length-=1}}.bind(this))};m.prototype=Object.create(n.prototype);
m.prototype.create=function(a,d){var b=new q(d),c=!1;if(a&&"[object Array]"===Object.prototype.toString.call(a)&&0<a.length)for(var c=!0,e=0,f=a.length;e<f;e++)a[e]instanceof h?function(a){b.tabs.enqueue(function(){chrome.tabs.move(a.properties.id,{index:-1,windowId:b.properties.id},function(b){for(var d in b)a.properties[d]=b[d];a.resolve(!0);this.dequeue()}.bind(b.tabs))});a._windowParent&&a._windowParent.tabs.removeTab(a);a._windowParent=b;a.properties.index=b.tabs.length;b.tabs.addTab(a,a.properties.index)}(a[e]):
function(a){var d=new h(a,b);b.tabs.addTab(d,d.properties.index);g.tabs.addTab(d);b.tabs.enqueue(function(){d.properties.windowId=b.properties.id;var a=d.properties;void 0!==a.closed&&delete a.closed;chrome.tabs.create(a,function(a){for(var b in a)d.properties[b]=a[b];this.dispatchEvent(new j("create",{tab:d,prevWindow:d._windowParent,prevTabGroup:null,prevPosition:NaN}));d.resolve(!0);g.tabs.dispatchEvent(new j("create",{tab:d,prevWindow:d._windowParent,prevTabGroup:null,prevPosition:NaN}));this.dequeue()}.bind(b.tabs))})}(a[e]);
else e=new h({active:!0},b),b.tabs.addTab(e,e.properties.index),g.tabs.addTab(e),b.tabs._lastFocusedTab=e,g.windows._lastFocusedWindow==b&&(g.tabs._lastFocusedTab=e);this[this.length]=b;this.length+=1;this.enqueue(chrome.windows.create,b.properties,function(a){for(var d in a)"tabs"!=d&&(b.properties[d]=a[d]);if(!0===c){d=0;for(var e=a.tabs.length;d<e;d++)g.tabs._blackList[a.tabs[d].id]=!0,b.tabs.enqueue(chrome.tabs.remove,a.tabs[d].id,function(){this.dequeue()}.bind(b.tabs))}else if(void 0!==a.tabs[0]&&
null!==a.tabs[0])for(d in a.tabs[0])b.tabs[0].properties[d]=a.tabs[0][d];b.resolve(!0);b.tabs.resolve(!0);d=0;for(e=b.tabs.length;d<e;d++)b.tabs[d].resolve(!0);this.dispatchEvent(new j("create",{browserWindow:b}));this.dequeue()}.bind(this));return b};m.prototype.getAll=function(){for(var a=[],d=0,b=this.length;d<b;d++)a[d]=this[d];return a};m.prototype.getLastFocused=function(){return this._lastFocusedWindow};m.prototype.close=function(a){a&&a instanceof q&&a.close()};var q=function(a){n.call(this);
this.properties=a||{};this._parent=null;this._operaId=Math.floor(1E16*Math.random());this.tabs=new r(this);this.tabGroups=new E(this);!0==this.properties.focused&&(g.windows._lastFocusedWindow=this);void 0!==this.properties.private&&(this.properties.incognito=!!this.properties.private,delete this.properties.private);void 0!==this.properties.closed&&delete this.properties.closed};q.prototype=Object.create(n.prototype);q.prototype.__defineGetter__("id",function(){return this._operaId});q.prototype.__defineGetter__("closed",
function(){return void 0!==this.properties.closed?!!this.properties.closed:!1});q.prototype.__defineGetter__("focused",function(){return void 0!==this.properties.focused?!!this.properties.focused:!1});q.prototype.__defineGetter__("private",function(){return void 0!==this.properties.incognito?!!this.properties.incognito:!1});q.prototype.__defineGetter__("parent",function(){return this._parent});q.prototype.insert=function(a,d){if(a&&a instanceof h){if(!0===this.properties.closed)throw new p("Invalid state",
"Current window is in the closed state and therefore is invalid");var b={windowId:this.properties.id,index:this.length};if(d&&d instanceof h){if(!0===d.closed)throw new p("Invalid state","'child' parameter is in the closed state and therefore is invalid");if(d._windowParent&&!0===d._windowParent.closed)throw new p("Invalid state","Parent window of 'child' parameter is in the closed state and therefore is invalid");b.windowId=d._windowParent?d._windowParent.properties.id:b.windowId;b.index=d.position}else b.index=
0<b.index?b.index-1:b.index;a._windowParent&&(a._oldWindowParent=a._windowParent,a._oldIndex=a.properties.index,a._oldWindowParent!==this&&a._windowParent.tabs.removeTab(a));a._windowParent=this;a.properties.index=b.index;this!==a._oldWindowParent&&this.tabs.addTab(a,a.properties.index);this.enqueue(chrome.tabs.move,a.properties.id,b,function(){this.dequeue()}.bind(this))}};q.prototype.focus=function(){this.properties.focused=!0;this.enqueue(chrome.windows.update,this.properties.id,{focused:!0},function(){this.dequeue()}.bind(this))};
q.prototype.update=function(a){delete a.closed;for(var d in a)this.properties[d]=a[d];this.enqueue(chrome.windows.update,this.properties.id,a,function(){this.dequeue()}.bind(this))};q.prototype.close=function(){!0!=this.properties.closed&&(this.properties.closed=!0,this.enqueue(function(){chrome.windows.remove(this.properties.id,function(){this.dequeue();g.windows.dequeue()}.bind(this))}.bind(this)))};var r=function(a){n.call(this);this.length=0;this._focusedTab=null;this.__defineGetter__("_lastFocusedTab",
function(){return this._focusedTab});this.__defineSetter__("_lastFocusedTab",function(a){this._focusedTab=a});this._parent=a;this.replaceTabs=function(a){for(var b=0,c=this.length;b<c;b++)delete this[b];this.length=0;if(!(0>=a.length)){b=0;for(c=a.length;b<c;b++)this!==g.tabs&&(a[b].properties.index=b),this[b]=a[b];this.length=a.length;for(var e=!1,b=0,c=a.length;b<c;b++)if(!0==a[b].properties.active){e=!0;break}e||a[0].focus()}};this.addTab=function(a,b){for(var c=[],e=0,f=this.length;e<f;e++)c[e]=
this[e],!0==c[e].properties.active&&(focusFound=!0);!0==a.properties.active&&a.focus();e=void 0!==b?b:c.length;c.splice(this!==g.tabs?e:this.length,0,a);e=0;for(f=c.length;e<f;e++)this!==g.tabs&&(c[e].properties.index=e),this[e]=c[e];this.length=c.length};this.removeTab=function(a){for(var b=this.length,c=[],e=-1,f=0,i=this.length;f<i;f++)c[f]=this[f],c[f].id==a.id&&(e=f);-1<e&&c.splice(e,1);f=0;for(i=c.length;f<i;f++)this!==g.tabs&&(c[f].properties.index=f),this[f]=c[f];this.length=c.length;if(b>
this.length){f=this.length;for(i=b;f<i;f++)delete this[f]}}};r.prototype=Object.create(n.prototype);r.prototype.create=function(a,d){if(d&&!(d instanceof h))throw new p("Type mismatch","Could not create BrowserTab object. 'before' attribute provided is invalid.");if(this._parent&&!0===this._parent.closed)throw new p("Invalid state","Parent window of the current BrowserTab object is in the closed state and therefore is invalid.");a=a||{};void 0!==a.closed&&delete a.closed;void 0!==a.private&&delete a.private;
var b=new h(a,this._parent||g.windows.getLastFocused()),a=b.properties;b.properties.index=a.index=b._windowParent.tabs.length;a.windowId=this._parent?this._parent.properties.id:g.windows.getLastFocused().properties.id;if(d&&d instanceof h){if(!0===d.closed)throw new p("Invalid state","'before' BrowserTab object is in the closed state and therefore is invalid.");if(d._windowParent&&!0===d._windowParent.closed)throw new p("Invalid state","Parent window of 'before' BrowserTab object is in the closed state and therefore is invalid.");
a.windowId=d._windowParent?d._windowParent.properties.id:a.windowId;a.index=d.position}this===g.tabs&&(b.properties.index=a.index=g.windows.getLastFocused().tabs.length);b._windowParent.tabs.addTab(b,b.properties.index);g.tabs.addTab(b);this.enqueue(chrome.tabs.create,a,function(a){for(var d in a)d!="url"&&(b.properties[d]=a[d]);if(this!==g.tabs){this.removeTab(b);this.addTab(b,b.properties.index)}b.resolve(true);this.dispatchEvent(new j("create",{tab:b,prevWindow:b._windowParent,prevTabGroup:null,
prevPosition:NaN}));this.dequeue()}.bind(this));return b};r.prototype.getAll=function(){for(var a=[],d=0,b=this.length;d<b;d++)a[d]=this[d];return a};r.prototype.getSelected=function(){return this._lastFocusedTab||this[0]};r.prototype.getFocused=r.prototype.getSelected;r.prototype.close=function(a){if(!a||!(a instanceof h))throw new p("Type mismatch","Expected browserTab argument to be of type BrowserTab.");a.close()};var N=function(){function a(a,b){if(!this._blackList[a]){for(var c=-1,e=0,f=this._allTabs.length;e<
f;e++)if(this._allTabs[e].properties.id==a){c=e;break}if(!(0>c)&&(c=this._allTabs[c]))c._oldWindowParent?c._oldWindowParent.tabs.removeTab(c):c._windowParent.tabs.removeTab(c),c._windowParent.tabs.addTab(c,b.toIndex),c.dispatchEvent(new j("move",{tab:c,prevWindow:c._oldWindowParent,prevTabGroup:null,prevPosition:c._oldIndex})),this.dispatchEvent(new j("move",{tab:c,prevWindow:c._oldWindowParent,prevTabGroup:null,prevPosition:c._oldIndex})),void 0!==c._oldWindowParent&&delete c._oldWindowParent,void 0!==
c._oldIndex&&delete c._oldIndex}}r.call(this);this._blackList={};this._allTabs=[];chrome.tabs.onCreated.addListener(function(a){l.setTimeout(function(){if(!this._blackList[a.id]){for(var b=-1,c=0,e=this._allTabs.length;c<e;c++){if(this._allTabs[c].rewriteUrl&&this._allTabs[c].properties.url==a.url){if(this._allTabs[c]._windowParent&&this._allTabs[c]._windowParent.properties.id!==a.windowId)for(var f=0,e=g.windows.length;f<e;f++)g.windows[f].properties.id==a.windowId&&(this._allTabs[c]._windowParent.tabs.removeTab(this._allTabs[c]),
this._allTabs[c].properties.index=this._allTabs[c]._windowParent.tabs.length,this._allTabs[c]._windowParent=g.windows[f],this._allTabs[c].properties.windowId=a.windowId,g.windows[f].tabs.addTab(this._allTabs[c],this._allTabs[c].properties.index));for(f in a)"url"==f||"windowId"==f||(this._allTabs[c].properties[f]=a[f]);this._allTabs[c].url=this._allTabs[c].rewriteUrl;delete this._allTabs[c].rewriteUrl;return}if(this._allTabs[c].properties.id==a.id){b=c;break}}if(0>b){for(var i,f=u.extension.windows,
c=0,e=f.length;c<e;c++)if(f[c].properties.id==a.windowId){i=f[c];break}i||(i=g.windows.getLastFocused());c=new h(a,i);c._windowParent.tabs.addTab(c,c.properties.index);this.addTab(c);c.resolve(!0)}else{for(c in a)this[b].properties[c]=a[c];c=this[b]}c._windowParent.tabs.dispatchEvent(new j("create",{tab:c,prevWindow:c._windowParent,prevTabGroup:null,prevPosition:NaN}));this.dispatchEvent(new j("create",{tab:c,prevWindow:c._windowParent,prevTabGroup:null,prevPosition:NaN}))}}.bind(this),200)}.bind(this));
chrome.tabs.onRemoved.addListener(function(a){if(!this._blackList[a]){for(var b=-1,c=0,e=this._allTabs.length;c<e;c++)if(this._allTabs[c].properties.id==a){b=c;break}if(!(0>b)){a=this._allTabs[b];c=a._oldWindowParent;b=a._oldIndex||a.properties.index;if(!c&&void 0!==a._windowParent&&null!==a._windowParent){a.properties.closed=!0;a._windowParent.tabs.removeTab(a);this.removeTab(a);c=0;for(e=a._windowParent.tabs.length;c<e;c++)!0==a._windowParent.tabs[c].properties.active?a._windowParent.tabs[c].focus():
a._windowParent.tabs[c].properties.active=!1;a.properties.index=NaN;c=a._windowParent;a._windowParent=null}a.dispatchEvent(new j("close",{tab:a,prevWindow:c,prevTabGroup:null,prevPosition:b}));c&&c.tabs.dispatchEvent(new j("close",{tab:a,prevWindow:c,prevTabGroup:null,prevPosition:b}));this.dispatchEvent(new j("close",{tab:a,prevWindow:c,prevTabGroup:null,prevPosition:b}))}}}.bind(this));chrome.tabs.onUpdated.addListener(function(a,b,c){for(var b=-1,e=0,f=this._allTabs.length;e<f;e++)if(this._allTabs[e].properties.id==
a){b=e;break}if(!(0>b)){var a=this._allTabs[b],g;for(g in c)"id"==g||"windowId"==g||(a.properties[g]=c[g]);!0==a.properties.active&&(a._windowParent&&a._windowParent.tabs._lastFocusedTab!==a)&&a.focus()}}.bind(this));chrome.tabs.onMoved.addListener(a.bind(this));chrome.tabs.onAttached.addListener(function(d,b){for(var c=-1,e=0,f=this._allTabs.length;e<f;e++)if(this._allTabs[e].properties.id==d){c=e;break}if(!(0>c)){var i=this._allTabs[c];i._oldWindowParent&&i._oldWindowParent.tabs.removeTab(i);l.setTimeout(function(){for(var c=
0,e=g.windows.length;c<e;c++)if(g.windows[c].properties.id==b.newWindowId){i._windowParent=g.windows[c];i.properties.index=b.newPosition;break}c={windowId:b.newWindowId,toIndex:b.newPosition};a.bind(this).call(this,d,c)}.bind(this),200)}}.bind(this));chrome.tabs.onDetached.addListener(function(a){for(var b=-1,c=0,e=this._allTabs.length;c<e;c++)if(this._allTabs[c].properties.id==a){b=c;break}if(!(0>b)&&(a=this._allTabs[b]))a._oldWindowParent=a._windowParent,a._oldIndex=a.position}.bind(this));chrome.tabs.onActivated.addListener(function(a){if(!this._blackList[a.tabId]&&
a.tabId)for(var b=0,c=this._allTabs.length;b<c;b++)if(this._allTabs[b].properties.id==a.tabId&&(this._allTabs[b].properties.active=!0,this._allTabs[b]._windowParent)){this._allTabs[b]._windowParent.tabs._lastFocusedTab=this._allTabs[b];g.windows._lastFocusedWindow===this._allTabs[b]._windowParent&&(g.tabs._lastFocusedTab=this._allTabs[b]);b=0;for(c=this._allTabs[b]._windowParent.tabs.length;b<c;b++)this._allTabs[b]._windowParent.tabs[b]!==this._allTabs[b]&&(this._allTabs[b]._windowParent.tabs[b].properties.active=
!1)}}.bind(this));g.addEventListener("controlmessage",function(a){if(a.data&&a.data.action&&"___O_getScreenshot_REQUEST"===a.data.action&&a.source.tabId){for(var b=null,c=0,e=this._allTabs.length;c<e;c++)if(this._allTabs[c].properties.id==a.source.tabId){b=this._allTabs[c];break}if(null!==b&&b._windowParent&&!0!=b._windowParent.properties.closed)try{chrome.tabs.captureVisibleTab(b._windowParent.properties.id,{},function(b){a.source.postMessage({action:"___O_getScreenshot_RESPONSE",dataUrl:b||null})}.bind(this))}catch(f){}else a.source.postMessage({action:"___O_getScreenshot_RESPONSE",
dataUrl:void 0})}}.bind(this))};N.prototype=Object.create(r.prototype);for(o in r.prototype)r.prototype.hasOwnProperty(o)&&(N.prototype[o]=r.prototype[o]);var h=function(a,d,b){if(!d)throw new p("Parent missing","BrowserTab objects can only be created with a window parent provided");n.call(this);this._windowParent=d;this.sanitizeProperties=function(a){void 0!==a.focused?(a.active=!!a.focused,delete a.focused):!0!==a.active&&(a.active=!1);void 0!==a.locked&&(a.pinned=!!a.locked,delete a.locked);if(void 0===
a.url||null===a.url)a.url="chrome://newtab";void 0!==a.position&&(a.index=a.position,delete a.position);if(void 0===a.index||null===a.index)a.index=this._windowParent.tabs.length;void 0!==a.closed&&delete a.closed;return a};this.properties=this.sanitizeProperties(a||{});this._operaId=Math.floor(1E16*Math.random());b||(this.rewriteUrl=this.properties.url,this.properties.url="chrome://newtab/#"+this._operaId);!0==this.properties.active&&this.focus();g.tabs._allTabs.push(this)};h.prototype=Object.create(n.prototype);
h.prototype.__defineGetter__("id",function(){return this._operaId});h.prototype.__defineGetter__("closed",function(){return void 0!==this.properties.closed?!!this.properties.closed:!1});h.prototype.__defineGetter__("locked",function(){return void 0!==this.properties.pinned?!!this.properties.pinned:!1});h.prototype.__defineGetter__("focused",function(){return void 0!==this.properties.active?!!this.properties.active:!1});h.prototype.__defineSetter__("focused",function(a){this.properties.active=!!a;
!0==this.properties.active&&this.focus()});h.prototype.__defineGetter__("selected",function(){return void 0!==this.properties.active?!!this.properties.active:!1});h.prototype.__defineSetter__("selected",function(a){this.properties.active=!!a;!0==this.properties.active&&this.focus()});h.prototype.__defineGetter__("private",function(){return void 0!==this.properties.incognito?!!this.properties.incognito:!1});h.prototype.__defineGetter__("faviconUrl",function(){return this.properties.closed?"":this.properties.favIconUrl||
""});h.prototype.__defineGetter__("title",function(){return this.properties.closed?"":this.properties.title||""});h.prototype.__defineGetter__("url",function(){return this.properties.closed?"":this.properties.url||""});h.prototype.__defineSetter__("url",function(a){this.properties.url=a+"";this.enqueue(chrome.tabs.update,this.properties.id,{url:this.properties.url},function(){this.dequeue()}.bind(this))});h.prototype.__defineGetter__("readyState",function(){return void 0!==this.properties.status?
this.properties.status:"loading"});h.prototype.__defineGetter__("browserWindow",function(){return this._windowParent});h.prototype.__defineGetter__("tabGroup",function(){return null});h.prototype.__defineGetter__("position",function(){return void 0!==this.properties.index?this.properties.index:NaN});h.prototype.focus=function(){if(!0!=this.properties.active){this.properties.active=!0;if(this._windowParent){this._windowParent.tabs._lastFocusedTab=this;g.windows._lastFocusedWindow===this._windowParent&&
(g.tabs._lastFocusedTab=this);for(var a=0,d=this._windowParent.tabs.length;a<d;a++)this._windowParent.tabs[a]!==this&&(this._windowParent.tabs[a].properties.active=!1)}this.enqueue(chrome.tabs.update,this.properties.id,{active:!0},function(){this.dequeue()}.bind(this))}};h.prototype.update=function(a){if(!0==this.properties.closed)throw new p("Invalid state","The current BrowserTab object is closed. Cannot call 'update' on this object.");var d={};void 0!==a.focused&&!0==a.focused&&(this.properties.active=
d.active=!!a.focused);void 0!==a.locked&&null!==a.locked&&(this.properties.pinned=d.pinned=!!a.locked);void 0!==a.url&&null!==a.url&&(this.propeerties.url=d.url=a.url);this.enqueue(chrome.tabs.update,this.properties.id,d,function(){this.dequeue()}.bind(this))};h.prototype.refresh=function(){};h.prototype.postMessage=function(a){if(!0===this.properties.closed)throw new p("Invalid state","The current BrowserTab object is in the closed state and therefore is invalid.");this.enqueue(chrome.tabs.sendMessage,
this.properties.id,a,function(){this.dequeue()}.bind(this))};h.prototype.getScreenshot=function(a){if(!0===this.properties.closed)throw new p("Invalid state","The current BrowserTab object is in the closed state and therefore is invalid.");if(!this._windowParent||!0===this._windowParent.properties.closed)a.call(this,void 0);else try{this.enqueue(chrome.tabs.captureVisibleTab,this._windowParent.properties.id,{},function(b){if(b){var c=document.createElement("canvas"),d=c.getContext("2d"),f=new Image;
f.onload=function(){c.width=f.width;c.height=f.height;d.drawImage(f,0,0);var b=d.getImageData(0,0,c.width,c.height);a.call(this,b);this.dequeue()}.bind(this);f.src=b}else a.call(this,void 0);this.dequeue()}.bind(this))}catch(d){}};h.prototype.close=function(){!0!=this.properties.closed&&!0!=this.properties.pinned&&(this.properties.closed=!0,this.properties.active=!1,this._oldWindowParent=this._windowParent,this._windowParent=null,this._oldIndex=this.properties.index,this.properties.index=void 0,this._oldWindowParent&&
this._oldWindowParent.tabs.removeTab(this),this.enqueue(chrome.tabs.remove,this.properties.id,function(){this.dequeue()}.bind(this)))};var E=function(a){B.mixin(this);this._parent=a;this.length=0};E.prototype=Object.create(k.prototype);E.prototype.create=function(){throw new p("Not supported","The current user agent does not support the Tab Groups feature.");};E.prototype.getAll=function(){return[]};g.windows=g.windows||new m;g.tabs=g.tabs||new N;g.tabGroups=g.tabGroups||new E;o=function(){B.mixin(this);
chrome.browserAction.onClicked.addListener(function(){this[0]&&this[0].dispatchEvent(new j("click",{}));this.dispatchEvent(new j("click",{}))}.bind(this))};o.prototype=Object.create(k.prototype);o.prototype.createItem=function(a){return new s(a)};o.prototype.addItem=function(a){a&&a instanceof s&&(this[0]=a,this.length=1,a.resolve(!0),a.apply(),a.badge.resolve(!0),a.badge.apply(),a.popup.resolve(!0),a.popup.apply(),chrome.browserAction.enable())};o.prototype.removeItem=function(a){a&&a instanceof
s&&(this[0]&&this[0]===a)&&(delete this[0],this.length=0,chrome.browserAction.disable(),a.dispatchEvent(new j("remove",{})),this.dispatchEvent(new j("remove",{})))};var t=function(a){n.call(this);this.properties={};this.properties.textContent=a.textContent;this.properties.backgroundColor=F(a.backgroundColor);this.properties.color=F(a.color);this.properties.display=a.display};t.prototype=Object.create(n.prototype);t.prototype.apply=function(){chrome.browserAction.setBadgeBackgroundColor({color:this.backgroundColor||
"#f00"});"block"===this.display?chrome.browserAction.setBadgeText({text:this.textContent}):chrome.browserAction.setBadgeText({text:""})};t.prototype.__defineGetter__("textContent",function(){return this.properties.textContent});t.prototype.__defineSetter__("textContent",function(a){this.properties.textContent=""+a;"block"===this.properties.display&&this.enqueue(chrome.browserAction.setBadgeText,{text:""+a})});t.prototype.__defineGetter__("backgroundColor",function(){return this.properties.backgroundColor});
t.prototype.__defineSetter__("backgroundColor",function(a){this.properties.backgroundColor=F(""+a);this.enqueue(chrome.browserAction.setBadgeBackgroundColor,{color:this.properties.backgroundColor})});t.prototype.__defineGetter__("color",function(){return this.properties.color});t.prototype.__defineSetter__("color",function(a){this.properties.color=F(""+a)});t.prototype.__defineGetter__("display",function(){return this.properties.display});t.prototype.__defineSetter__("display",function(a){"block"===
(""+a).toLowerCase()?(this.properties.display="block",this.enqueue(chrome.browserAction.setBadgeText,{text:this.properties.textContent})):(this.properties.display="none",this.enqueue(chrome.browserAction.setBadgeText,{text:""}))});var v=function(a){n.call(this);this.properties={};this.properties.href=a.href||"";this.properties.width=a.width;this.properties.height=a.height};v.prototype=Object.create(n.prototype);v.prototype.apply=function(){chrome.browserAction.setPopup({popup:this.href})};v.prototype.__defineGetter__("href",
function(){return this.properties.href});v.prototype.__defineSetter__("href",function(a){this.properties.href=""+a;this.enqueue(chrome.browserAction.setPopup,{popup:""+a})});v.prototype.__defineGetter__("width",function(){return this.properties.width});v.prototype.__defineSetter__("width",function(a){this.properties.width=a});v.prototype.__defineGetter__("height",function(){return this.properties.height});v.prototype.__defineSetter__("height",function(a){this.properties.height=a});var s=function(a){n.call(this);
this.properties={};this.properties.disabled=a.disabled||!1;this.properties.title=a.title||"";this.properties.icon=a.icon||"";this.properties.popup=new v(a.popup||{});this.properties.badge=new t(a.badge||{})};s.prototype=Object.create(n.prototype);s.prototype.apply=function(){!0===this.disabled?chrome.browserAction.disable():chrome.browserAction.enable();chrome.browserAction.setTitle({title:this.title});chrome.browserAction.setIcon({path:this.icon})};s.prototype.__defineGetter__("disabled",function(){return this.properties.disabled});
s.prototype.__defineSetter__("disabled",function(a){this.properties.disabled!==a&&(!0===a||"true"===a||1===a||"1"===a?(this.properties.disabled=!0,this.enqueue(chrome.browserAction.disable)):(this.properties.disabled=!1,this.enqueue(chrome.browserAction.enable)))});s.prototype.__defineGetter__("title",function(){return this.properties.title});s.prototype.__defineSetter__("title",function(a){this.properties.title=""+a;this.enqueue(chrome.browserAction.setTitle,{title:this.title})});s.prototype.__defineGetter__("icon",
function(){return this.properties.icon});s.prototype.__defineSetter__("icon",function(a){this.properties.icon=""+a;this.enqueue(chrome.browserAction.setIcon,{path:this.icon})});s.prototype.__defineGetter__("popup",function(){return this.properties.popup});s.prototype.__defineGetter__("badge",function(){return this.properties.badge});S.toolbar=S.toolbar||new o;if(l.opera)z=!0,u.isReady=function(a){a.call(u);for(var a=0,d=x.length;a<d;a++){var b=x[a];b.target[b.methodName].apply(b.target,b.args)}x=
[]};else{o=function(a,d){var b=a.addEventListener;a.addEventListener=function(c,e,f){c.toLowerCase()===d.toLowerCase()?void 0===e||(null===e||"[object Function]"!==Object.prototype.toString.call(e))||(z?e.call(l):w[d.toLowerCase()].push(e)):b.call(a,c,e,f)};a.__defineSetter__("on"+d.toLowerCase(),function(b){a.addEventListener(d.toLowerCase(),b,!1)})};var T=function(a,d){for(var b=a.toLowerCase(),c=new j(b,{}),e=0,f=w[b].length;e<f;e++)w[b][e].call(d,c);w[b]=[]},w={isready:[],domcontentloaded:[],
load:[]},U=!1,J=!1;l.document.addEventListener("DOMContentLoaded",function d(){U=!0;l.document.removeEventListener("DOMContentLoaded",d,!0)},!0);l.addEventListener("load",function b(){J=!0;l.removeEventListener("load",b,!0)},!0);o(l,"load");o(l.document,"domcontentloaded");o(l,"domcontentloaded");var Y=(new Date).getTime()+3E3;(function c(){if((new Date).getTime()>=Y)console.warn("opera.isReady check timed out"),J=!0;else for(var e in D)if(!0!==D[e]){l.setTimeout(function(){c()},20);return}l.setTimeout(function(){if(!z){for(var c=
0,e=w.isready.length;c<e;c++)w.isready[c].call(l);w.isready=[];var g=(new Date).getTime()+3E3;(function V(){var c=(new Date).getTime();if(U||J||c>=g){T("domcontentloaded",l.document);c>=g&&console.warn("document.domcontentloaded event fired on check timeout");var e=(new Date).getTime()+3E3;(function W(){var c=(new Date).getTime();if(J||c>=e){T("load",window);c>=e&&console.warn("window.load event fired on check timeout");for(var c=0,f=x.length;c<f;c++){var g=x[c];g.target[g.methodName].apply(g.target,
g.args)}x=[]}else l.setTimeout(function(){W()},50)})()}else l.setTimeout(function(){V()},50)})();z=!0}},0)})();u.isReady=function(c){z?c.call(l):w.isready.push(c)}}l.opera=u}(window);
