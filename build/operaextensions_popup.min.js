// operaextensions_popup.min.js - http://github.com/operasoftware/operaextensions.js
'use strict';!function(d){function y(a,e,b){j?a[e].apply(a,b):k.push({target:a,methodName:e,args:b})}var g=function(){};g.prototype.REVISION="1";g.prototype.version=function(){return this.REVISION};g.prototype.buildNumber=function(){return this.REVISION};g.prototype.postError=function(a){console.log(a)};var i=d.opera||new g,g=chrome.app.getDetails();navigator.browserLanguage=navigator.language;var j=!1,k=[];/OPR/.test(navigator.userAgent);var z={},m={},f="undefined"!==typeof window?window:{},f=f.MutationObserver||
f.WebKitMutationObserver;if("undefined"!==typeof process&&"[object process]"==={}.toString.call(process))f=function(a,e){process.nextTick(function(){a.call(e)})};else if(f){var v=[],f=new f(function(){var a=v.slice();v=[];a.forEach(function(a){a[0].call(a[1])})}),A=document.createElement("div");f.observe(A,{attributes:!0});f=function(a,e){v.push([a,e]);A.setAttribute("drainQueue","drainQueue")}}else f=function(a,e){setTimeout(function(){a.call(e)},1)};m.async=f;var F=m.Event=function(a,e){this.type=
a;for(var b in e)e.hasOwnProperty(b)&&(this[b]=e[b])},B=function(a,e){for(var b=0,c=a.length;b<c;b++)if(a[b][0]===e)return b;return-1},w=function(a){var e=a._promiseCallbacks;e||(e=a._promiseCallbacks={});return e},x=m.EventTarget={mixin:function(a){a.on=this.on;a.off=this.off;a.trigger=this.trigger;return a},on:function(a,e,b){for(var c=w(this),h,d,a=a.split(/\s+/),b=b||this;d=a.shift();)(h=c[d])||(h=c[d]=[]),-1===B(h,e)&&h.push([e,b])},off:function(a,e){for(var b=w(this),c,h,a=a.split(/\s+/);c=
a.shift();)e?(c=b[c],h=B(c,e),-1!==h&&c.splice(h,1)):b[c]=[]},trigger:function(a,e){var b,c,h,d;if(b=w(this)[a])for(var f=0,g=b.length;f<g;f++)c=b[f],h=c[0],c=c[1],"object"!==typeof e&&(e={detail:e}),d=new F(a,e),h.call(c,d)}},p=m.Promise=function(){this.on("promise:resolved",function(a){this.trigger("success",{detail:a.detail})},this);this.on("promise:failed",function(a){this.trigger("error",{detail:a.detail})},this)},C=function(){},D=function(a,e,b,c){var h,d;if(b)try{h=b(c.detail)}catch(f){d=f}else h=
c.detail;if(h instanceof p)h.then(function(a){e.resolve(a)},function(a){e.reject(a)});else if(b&&h)e.resolve(h);else if(d)e.reject(d);else e[a](h)};p.prototype={then:function(a,e){var b=new p;this.on("promise:resolved",function(e){D("resolve",b,a,e)});this.on("promise:failed",function(a){D("reject",b,e,a)});return b},resolve:function(a){m.async(function(){this.trigger("promise:resolved",{detail:a});this.isResolved=a},this);this.reject=this.resolve=C},reject:function(a){m.async(function(){this.trigger("promise:failed",
{detail:a});this.isRejected=a},this);this.reject=this.resolve=C}};x.mixin(p.prototype);var q=function(a,e){var b=e||{};b.type=a;b.target||(b.target=d);b.currentTarget||(b.currentTarget=b.target);b.srcElement||(b.srcElement=b.target);!0!==b.bubbles&&(b.bubbles=!1);!0!==b.cancelable&&(b.cancelable=!1);b.timeStamp||(b.timeStamp=0);return b},f=function(){x.mixin(this)};f.prototype.constructor=f;f.prototype.addEventListener=function(a,e){this.on(a,e)};f.prototype.removeEventListener=function(a,e){this.off(a,
e)};f.prototype.dispatchEvent=function(a){var e=a.type;if("function"===typeof this["on"+e.toLowerCase()])this.on(e,this["on"+e.toLowerCase()]);this.trigger(e,a)};Object.create(p.prototype);for(var r in f.prototype);var u=function(a){x.mixin(this);this._isBackground=a||!1;this._localPort=null;this._isBackground||(this._localPort=chrome.extension.connect({name:""+Math.floor(1E16*Math.random())}),this._localPort.onDisconnect.addListener(function(){this.dispatchEvent(new q("disconnect",{source:this._localPort}));
this._localPort=null}.bind(this)),a=function(a,b,c){var d=this._localPort;a&&a.action&&0===a.action.indexOf("___O_")?this.dispatchEvent(new q("controlmessage",{data:a,source:{postMessage:function(a){d.postMessage(a)},tabId:b&&b.tab?b.tab.id:null}})):y(this,"dispatchEvent",[new q("message",{data:a,source:{postMessage:function(a){d.postMessage(a)},tabId:b&&b.tab?b.tab.id:null}})]);c&&c({})}.bind(this),this._localPort.onMessage.addListener(a),chrome.extension.onMessage.addListener(a),y(this,"dispatchEvent",
[new q("connect",{source:this._localPort,origin:""})]))};u.prototype=Object.create(f.prototype);u.prototype.postMessage=function(a){this._isBackground?this.broadcastMessage(a):this._localPort&&this._localPort.postMessage(a)};r=function(){u.call(this,!1)};r.prototype=Object.create(u.prototype);r.prototype.__defineGetter__("bgProcess",function(){return chrome.extension.getBackgroundPage()});var f=i.extension=i.extension||new r,n=i.contexts=i.contexts||{};r.prototype.getFile=function(a){var e=null;if("string"!=
typeof a)return e;try{var b=chrome.extension.getURL("");0==a.indexOf("widget:")&&(a=a.replace("widget:","chrome-extension:"));0==a.indexOf("/")&&(a=a.substring(1));var a=(-1==a.indexOf(b)?b:"")+a,c=new XMLHttpRequest;c.onloadend=function(){c.readyState==c.DONE&&200==c.status&&(result=c.response,result.name=a.substring(a.lastIndexOf("/")+1),result.lastModifiedDate=null,result.toString=function(){return"[object File]"},e=result)};c.open("GET",a,!1);c.responseType="blob";c.send(null)}catch(d){}return e};
d.widget=d.widget||f.bgProcess.widget;g&&(g.permissions&&-1!=g.permissions.indexOf("tabs"))&&(f.windows=f.windows||f.bgProcess.opera.extension.windows);g&&(g.permissions&&-1!=g.permissions.indexOf("tabs"))&&(f.tabs=f.tabs||f.bgProcess.opera.extension.tabs);g&&(g.permissions&&-1!=g.permissions.indexOf("tabs"))&&(f.tabGroups=f.tabGroups||f.bgProcess.opera.extension.tabGroups);g&&(void 0!==g.browser_action&&null!==g.browser_action)&&(n.toolbar=n.toolbar||f.bgProcess.opera.contexts.toolbar);g&&(g.permissions&&
-1!=g.permissions.indexOf("contextMenus"))&&(d.MenuItem=f.bgProcess.MenuItem,d.MenuContext=f.bgProcess.MenuContext,n.menu=n.menu||f.bgProcess.opera.contexts.menu);d.opr&&(d.opr.speeddial&&g&&g.speeddial)&&(n.speeddial=n.speeddial||f.bgProcess.opera.contexts.speeddial);if(d.opera)j=!0,i.isReady=function(a){a.call(i);for(var a=0,e=k.length;a<e;a++){var b=k[a];b.target[b.methodName].apply(b.target,b.args)}k=[]};else{var g=function(a,e){var b=a.addEventListener;a.addEventListener=function(c,h,f){c=c+
"";c.toLowerCase()===e.toLowerCase()?h===void 0||(h===null||Object.prototype.toString.call(h)!=="[object Function]")||(j?h.call(d):l[e.toLowerCase()].push(h)):b.call(a,c,h,f)};a.__defineSetter__("on"+e.toLowerCase(),function(b){a.addEventListener(e.toLowerCase(),b,false)})},s=function(a,e,b){for(var a=a.toLowerCase(),b=new q(a,b||{}),d=0,h=l[a].length;d<h;d++)l[a][d].call(e,b)},l={isready:[],readystatechange:[],domcontentloaded:[],load:[]},t=!1,o=!1;"interactive"===d.document.readyState&&(t=!0);"complete"===
d.document.readyState&&(o=t=!0);d.document.addEventListener("DOMContentLoaded",function e(){t=true;d.document.removeEventListener("DOMContentLoaded",e,true)},!0);d.addEventListener("load",function b(){o=true;d.removeEventListener("load",b,true)},!0);d.document.addEventListener("readystatechange",function(b){b.stopImmediatePropagation();b.stopPropagation();d.document.readyState!=="interactive"&&d.document.readyState!=="complete"?s("readystatechange",d.document):d.document.readyState="loading"},!0);
var E=t||o?d.document.readyState:"uninitialized";d.document.__defineSetter__("readyState",function(b){E=b});d.document.__defineGetter__("readyState",function(){return E});g(d,"load");g(d.document,"domcontentloaded");g(d,"domcontentloaded");g(d.document,"readystatechange");var G=(new Date).getTime()+24E4;(function c(){if((new Date).getTime()>=G){console.warn("opera.isReady check timed out");o=true}else for(var h in z)if(z[h]!==true){d.setTimeout(function(){c()},20);return}d.setTimeout(function(){if(!j){for(var c=
0,h=l.isready.length;c<h;c++)l.isready[c].call(d);l.isready=[];var f=(new Date).getTime()+12E4;(function H(){var c=(new Date).getTime();if(t||o||c>=f){d.document.readyState="interactive";s("readystatechange",d.document);s("domcontentloaded",d.document,{bubbles:true});c>=f&&console.warn("document.domcontentloaded event fired on check timeout");var h=(new Date).getTime()+12E4;(function I(){var c=(new Date).getTime();if(o||c>=h){d.document.readyState="complete";s("readystatechange",d.document);s("load",
d);c>=h&&console.warn("window.load event fired on check timeout");for(var c=0,f=k.length;c<f;c++){var g=k[c];g.target[g.methodName].apply(g.target,g.args)}k=[]}else d.setTimeout(function(){I()},50)})()}else d.setTimeout(function(){H()},50)})();j=true}},0)})();i.isReady=function(c){j?c.call(d):l.isready.push(c)}}i.isReady(function(){function c(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");c=RegExp("[\\?&]"+c+"=([^&#]*)").exec(window.location.search);return c==null?"":window.decodeURIComponent(c[1].replace(/\+/g,
" "))}window.addEventListener("DOMContentLoaded",function(){var d=c("w"),f=c("h");document.body.style.minWidth=d!==""?d.replace(/\D/g,"")+"px":"300px";document.body.style.minHeight=f!==""?f.replace(/\D/g,"")+"px":"300px"},false)});i.isReady(function(){document.addEventListener("DOMContentLoaded",function(){for(var c=["load","beforeunload","unload","click","dblclick","mouseover","mousemove","mousedown","mouseup","mouseout","keydown","keypress","keyup","blur","focus"],d=0,f=c.length;d<f;d++)for(var g=
document.querySelectorAll("[on"+c[d]+"]"),i=0,k=g.length;i<k;i++){var l=new Function("e",g[i].getAttribute("on"+c[d])),j=g[i];c[d].indexOf("load")>-1&&g[i]===document.body&&(j=window);g[i].removeAttribute("on"+c[d]);j.addEventListener(c[d],l,true)}},false)});d.opera=i}(window);
