// operaextensions_popup.min.js - http://github.com/operasoftware/operaextensions.js
'use strict';!function(c){function h(a,d,f){l?a[d].apply(a,f):j.push({target:a,methodName:d,args:f})}var e=function(){};e.prototype.REVISION="1";e.prototype.version=function(){return this.REVISION};e.prototype.buildNumber=function(){return this.REVISION};e.prototype.postError=function(a){console.log(a)};var i=c.opera||new e,e=chrome.app.getDetails(),l=!1,j=[],x={},m={},b="undefined"!==typeof window?window:{},b=b.MutationObserver||b.WebKitMutationObserver;if("undefined"!==typeof process&&"[object process]"===
{}.toString.call(process))b=function(a,d){process.nextTick(function(){a.call(d)})};else if(b){var u=[],b=new b(function(){var a=u.slice();u=[];a.forEach(function(a){a[0].call(a[1])})}),y=document.createElement("div");b.observe(y,{attributes:!0});b=function(a,d){u.push([a,d]);y.setAttribute("drainQueue","drainQueue")}}else b=function(a,d){setTimeout(function(){a.call(d)},1)};m.async=b;var E=m.Event=function(a,d){this.type=a;for(var f in d)d.hasOwnProperty(f)&&(this[f]=d[f])},z=function(a,d){for(var f=
0,g=a.length;f<g;f++)if(a[f][0]===d)return f;return-1},v=function(a){var d=a._promiseCallbacks;d||(d=a._promiseCallbacks={});return d},w=m.EventTarget={mixin:function(a){a.on=this.on;a.off=this.off;a.trigger=this.trigger;return a},on:function(a,d,f){for(var g=v(this),c,b,a=a.split(/\s+/),f=f||this;b=a.shift();)(c=g[b])||(c=g[b]=[]),-1===z(c,d)&&c.push([d,f])},off:function(a,d){for(var f=v(this),g,c,a=a.split(/\s+/);g=a.shift();)d?(g=f[g],c=z(g,d),-1!==c&&g.splice(c,1)):f[g]=[]},trigger:function(a,
d){var f,g,c,b;if(f=v(this)[a])for(var e=0,h=f.length;e<h;e++)g=f[e],c=g[0],g=g[1],"object"!==typeof d&&(d={detail:d}),b=new E(a,d),c.call(g,b)}},n=m.Promise=function(){this.on("promise:resolved",function(a){this.trigger("success",{detail:a.detail})},this);this.on("promise:failed",function(a){this.trigger("error",{detail:a.detail})},this)},A=function(){},B=function(a,d,f,g){var c,b;if(f)try{c=f(g.detail)}catch(e){b=e}else c=g.detail;if(c instanceof n)c.then(function(a){d.resolve(a)},function(a){d.reject(a)});
else if(f&&c)d.resolve(c);else if(b)d.reject(b);else d[a](c)};n.prototype={then:function(a,d){var f=new n;this.on("promise:resolved",function(d){B("resolve",f,a,d)});this.on("promise:failed",function(a){B("reject",f,d,a)});return f},resolve:function(a){m.async(function(){this.trigger("promise:resolved",{detail:a});this.isResolved=a},this);this.reject=this.resolve=A},reject:function(a){m.async(function(){this.trigger("promise:failed",{detail:a});this.isRejected=a},this);this.reject=this.resolve=A}};
w.mixin(n.prototype);var o=function(a,d){var f=document.createEvent("Event");f.initEvent(a,!0,!0);for(var c in d)f[c]=d[c];return f},b=function(){w.mixin(this)};b.prototype.constructor=b;b.prototype.addEventListener=function(a,d){this.on(a,d)};b.prototype.removeEventListener=function(a,d){this.off(a,d)};b.prototype.dispatchEvent=function(a){var d=a.type;if("function"===typeof this["on"+d.toLowerCase()])this.on(d,this["on"+d.toLowerCase()]);this.trigger(d,a)};Object.create(n.prototype);for(var p in b.prototype);
var r=function(a){w.mixin(this);this._isBackground=a||!1;this._localPort=null;this._isBackground||(this._localPort=chrome.extension.connect({name:""+Math.floor(1E16*Math.random())}),this._localPort.onDisconnect.addListener(function(){this.dispatchEvent(new o("disconnect",{source:this._localPort}));this._localPort=null}.bind(this)),a=function(a,f,c){var b=this._localPort;a&&a.action&&0===a.action.indexOf("___O_")?this.dispatchEvent(new o("controlmessage",{data:a,source:{postMessage:function(a){b.postMessage(a)},
tabId:f&&f.tab?f.tab.id:null}})):h(this,"dispatchEvent",[new o("message",{data:a,source:{postMessage:function(a){b.postMessage(a)},tabId:f&&f.tab?f.tab.id:null}})]);c&&c({})}.bind(this),this._localPort.onMessage.addListener(a),chrome.extension.onMessage.addListener(a),h(this,"dispatchEvent",[new o("connect",{source:this._localPort,origin:""})]))};r.prototype=Object.create(b.prototype);r.prototype.postMessage=function(a){this._isBackground?this.broadcastMessage(a):this._localPort&&this._localPort.postMessage(a)};
p=function(){r.call(this,!1)};p.prototype=Object.create(r.prototype);p.prototype.__defineGetter__("bgProcess",function(){return chrome.extension.getBackgroundPage()});var b=i.extension=i.extension||new p,s=i.contexts=i.contexts||{};p.prototype.getFile=function(a){var d=null;if("string"!=typeof a)return d;try{var c=chrome.extension.getURL("");0==a.indexOf("widget:")&&(a=a.replace("widget:","chrome-extension:"));0==a.indexOf("/")&&(a=a.substring(1));var a=(-1==a.indexOf(c)?c:"")+a,b=new XMLHttpRequest;
b.onloadend=function(){b.readyState==b.DONE&&200==b.status&&(result=b.response,result.name=a.substring(a.lastIndexOf("/")+1),result.lastModifiedDate=null,result.toString=function(){return"[object File]"},d=result)};b.open("GET",a,!1);b.responseType="blob";b.send(null)}catch(e){}return d};c.widget=c.widget||b.bgProcess.widget;e&&(e.permissions&&-1!=e.permissions.indexOf("tabs"))&&(b.windows=b.windows||b.bgProcess.opera.extension.windows);e&&(e.permissions&&-1!=e.permissions.indexOf("tabs"))&&(b.tabs=
b.tabs||b.bgProcess.opera.extension.tabs);e&&(e.permissions&&-1!=e.permissions.indexOf("tabs"))&&(b.tabGroups=b.tabGroups||b.bgProcess.opera.extension.tabGroups);e&&(void 0!==e.browser_action&&null!==e.browser_action)&&(s.toolbar=s.toolbar||b.bgProcess.opera.contexts.toolbar);e&&(e.permissions&&-1!=e.permissions.indexOf("contextMenus"))&&(c.MenuItem=b.bgProcess.MenuItem,c.MenuContext=b.bgProcess.MenuContext,s.menu=s.menu||b.bgProcess.opera.contexts.menu);if(c.opera)l=!0,i.isReady=function(a){a.call(i);
for(var a=0,c=j.length;a<c;a++){var f=j[a];f.target[f.methodName].apply(f.target,f.args)}j=[]};else{var e=function(a,d){var f=a.addEventListener;a.addEventListener=function(b,e,h){b=b+"";b.toLowerCase()===d.toLowerCase()?e===void 0||(e===null||Object.prototype.toString.call(e)!=="[object Function]")||(l?e.call(c):k[d.toLowerCase()].push(e)):f.call(a,b,e,h)};a.__defineSetter__("on"+d.toLowerCase(),function(c){a.addEventListener(d.toLowerCase(),c,false)})},q=function(a,c,b){for(var a=a.toLowerCase(),
b=new o(a,b||{}),e=0,h=k[a].length;e<h;e++)k[a][e].call(c,b)},k={isready:[],readystatechange:[],domcontentloaded:[],load:[]},C=!1,t=!1;c.document.addEventListener("DOMContentLoaded",function d(){C=true;c.document.removeEventListener("DOMContentLoaded",d,true)},!0);c.addEventListener("load",function f(){t=true;c.removeEventListener("load",f,true)},!0);c.document.addEventListener("readystatechange",function(b){b.stopImmediatePropagation();b.stopPropagation();c.document.readyState!=="interactive"&&c.document.readyState!==
"complete"?q("readystatechange",c.document):c.document.readyState="loading"},!0);var D="uninitialized";c.document.__defineSetter__("readyState",function(c){D=c});c.document.__defineGetter__("readyState",function(){return D});e(c,"load");e(c.document,"domcontentloaded");e(c,"domcontentloaded");e(c.document,"readystatechange");var F=(new Date).getTime()+3E3;(function g(){if((new Date).getTime()>=F){console.warn("opera.isReady check timed out");t=true}else for(var b in x)if(x[b]!==true){c.setTimeout(function(){g()},
20);return}c.setTimeout(function(){if(!l){for(var b=0,e=k.isready.length;b<e;b++)k.isready[b].call(c);k.isready=[];var g=(new Date).getTime()+3E3;(function G(){var b=(new Date).getTime();if(C||t||b>=g){c.document.readyState="interactive";q("readystatechange",c.document);q("domcontentloaded",c.document,{bubbles:true});b>=g&&console.warn("document.domcontentloaded event fired on check timeout");var e=(new Date).getTime()+3E3;(function H(){var b=(new Date).getTime();if(t||b>=e){c.document.readyState=
"complete";q("readystatechange",c.document);q("load",window);b>=e&&console.warn("window.load event fired on check timeout");for(var b=0,g=j.length;b<g;b++){var h=j[b];h.target[h.methodName].apply(h.target,h.args)}j=[]}else c.setTimeout(function(){H()},50)})()}else c.setTimeout(function(){G()},50)})();l=true}},0)})();i.isReady=function(b){l?b.call(c):k.isready.push(b)}}c.opera=i}(window);
opera.isReady(function(){function c(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");c=RegExp("[\\?&]"+c+"=([^&#]*)").exec(window.location.search);return null==c?"":window.decodeURIComponent(c[1].replace(/\+/g," "))}window.addEventListener("DOMContentLoaded",function(){var h=c("w"),e=c("h");document.body.style.minWidth=""!==h?h.replace(/\D/g,"")+"px":"300px";document.body.style.minHeight=""!==e?e.replace(/\D/g,"")+"px":"300px"},!1)});
