// operaextensions_popup.min.js - http://github.com/operasoftware/operaextensions.js
'use strict';!function(c){function g(a,e,f){j?a[e].apply(a,f):k.push({target:a,methodName:e,args:f})}var d=function(){};d.prototype.REVISION="1";d.prototype.version=function(){return this.REVISION};d.prototype.buildNumber=function(){return this.REVISION};d.prototype.postError=function(a){console.log(a)};var i=c.opera||new d,d=chrome.app.getDetails();navigator.browserLanguage=navigator.language;var j=!1,k=[],r={},l={},b="undefined"!==typeof window?window:{},b=b.MutationObserver||b.WebKitMutationObserver;
if("undefined"!==typeof process&&"[object process]"==={}.toString.call(process))b=function(a,e){process.nextTick(function(){a.call(e)})};else if(b){var v=[],b=new b(function(){var a=v.slice();v=[];a.forEach(function(a){a[0].call(a[1])})}),y=document.createElement("div");b.observe(y,{attributes:!0});b=function(a,e){v.push([a,e]);y.setAttribute("drainQueue","drainQueue")}}else b=function(a,e){setTimeout(function(){a.call(e)},1)};l.async=b;var E=l.Event=function(a,e){this.type=a;for(var f in e)e.hasOwnProperty(f)&&
(this[f]=e[f])},z=function(a,e){for(var f=0,h=a.length;f<h;f++)if(a[f][0]===e)return f;return-1},w=function(a){var e=a._promiseCallbacks;e||(e=a._promiseCallbacks={});return e},x=l.EventTarget={mixin:function(a){a.on=this.on;a.off=this.off;a.trigger=this.trigger;return a},on:function(a,e,f){for(var h=w(this),c,b,a=a.split(/\s+/),f=f||this;b=a.shift();)(c=h[b])||(c=h[b]=[]),-1===z(c,e)&&c.push([e,f])},off:function(a,e){for(var f=w(this),h,c,a=a.split(/\s+/);h=a.shift();)e?(h=f[h],c=z(h,e),-1!==c&&
h.splice(c,1)):f[h]=[]},trigger:function(a,e){var f,h,c,b;if(f=w(this)[a])for(var d=0,g=f.length;d<g;d++)h=f[d],c=h[0],h=h[1],"object"!==typeof e&&(e={detail:e}),b=new E(a,e),c.call(h,b)}},n=l.Promise=function(){this.on("promise:resolved",function(a){this.trigger("success",{detail:a.detail})},this);this.on("promise:failed",function(a){this.trigger("error",{detail:a.detail})},this)},A=function(){},B=function(a,e,f,c){var b,d;if(f)try{b=f(c.detail)}catch(g){d=g}else b=c.detail;if(b instanceof n)b.then(function(a){e.resolve(a)},
function(a){e.reject(a)});else if(f&&b)e.resolve(b);else if(d)e.reject(d);else e[a](b)};n.prototype={then:function(a,e){var f=new n;this.on("promise:resolved",function(e){B("resolve",f,a,e)});this.on("promise:failed",function(a){B("reject",f,e,a)});return f},resolve:function(a){l.async(function(){this.trigger("promise:resolved",{detail:a});this.isResolved=a},this);this.reject=this.resolve=A},reject:function(a){l.async(function(){this.trigger("promise:failed",{detail:a});this.isRejected=a},this);this.reject=
this.resolve=A}};x.mixin(n.prototype);var o=function(a,e){var f=document.createEvent("Event");f.initEvent(a,!0,!0);for(var c in e)f[c]=e[c];return f},b=function(){x.mixin(this)};b.prototype.constructor=b;b.prototype.addEventListener=function(a,e){this.on(a,e)};b.prototype.removeEventListener=function(a,e){this.off(a,e)};b.prototype.dispatchEvent=function(a){var e=a.type;if("function"===typeof this["on"+e.toLowerCase()])this.on(e,this["on"+e.toLowerCase()]);this.trigger(e,a)};Object.create(n.prototype);
for(var p in b.prototype);var s=function(a){x.mixin(this);this._isBackground=a||!1;this._localPort=null;this._isBackground||(this._localPort=chrome.extension.connect({name:""+Math.floor(1E16*Math.random())}),this._localPort.onDisconnect.addListener(function(){this.dispatchEvent(new o("disconnect",{source:this._localPort}));this._localPort=null}.bind(this)),a=function(a,c,b){var d=this._localPort;a&&a.action&&0===a.action.indexOf("___O_")?this.dispatchEvent(new o("controlmessage",{data:a,source:{postMessage:function(a){d.postMessage(a)},
tabId:c&&c.tab?c.tab.id:null}})):g(this,"dispatchEvent",[new o("message",{data:a,source:{postMessage:function(a){d.postMessage(a)},tabId:c&&c.tab?c.tab.id:null}})]);b&&b({})}.bind(this),this._localPort.onMessage.addListener(a),chrome.extension.onMessage.addListener(a),g(this,"dispatchEvent",[new o("connect",{source:this._localPort,origin:""})]))};s.prototype=Object.create(b.prototype);s.prototype.postMessage=function(a){this._isBackground?this.broadcastMessage(a):this._localPort&&this._localPort.postMessage(a)};
p=function(){s.call(this,!1)};p.prototype=Object.create(s.prototype);p.prototype.__defineGetter__("bgProcess",function(){return chrome.extension.getBackgroundPage()});var b=i.extension=i.extension||new p,t=i.contexts=i.contexts||{};p.prototype.getFile=function(a){var c=null;if("string"!=typeof a)return c;try{var f=chrome.extension.getURL("");0==a.indexOf("widget:")&&(a=a.replace("widget:","chrome-extension:"));0==a.indexOf("/")&&(a=a.substring(1));var a=(-1==a.indexOf(f)?f:"")+a,b=new XMLHttpRequest;
b.onloadend=function(){b.readyState==b.DONE&&200==b.status&&(result=b.response,result.name=a.substring(a.lastIndexOf("/")+1),result.lastModifiedDate=null,result.toString=function(){return"[object File]"},c=result)};b.open("GET",a,!1);b.responseType="blob";b.send(null)}catch(d){}return c};c.widget=c.widget||b.bgProcess.widget;d&&(d.permissions&&-1!=d.permissions.indexOf("tabs"))&&(b.windows=b.windows||b.bgProcess.opera.extension.windows);d&&(d.permissions&&-1!=d.permissions.indexOf("tabs"))&&(b.tabs=
b.tabs||b.bgProcess.opera.extension.tabs);d&&(d.permissions&&-1!=d.permissions.indexOf("tabs"))&&(b.tabGroups=b.tabGroups||b.bgProcess.opera.extension.tabGroups);d&&(void 0!==d.browser_action&&null!==d.browser_action)&&(t.toolbar=t.toolbar||b.bgProcess.opera.contexts.toolbar);d&&(d.permissions&&-1!=d.permissions.indexOf("contextMenus"))&&(c.MenuItem=b.bgProcess.MenuItem,c.MenuContext=b.bgProcess.MenuContext,t.menu=t.menu||b.bgProcess.opera.contexts.menu);if(c.opera)j=!0,i.isReady=function(a){a.call(i);
for(var a=0,c=k.length;a<c;a++){var b=k[a];b.target[b.methodName].apply(b.target,b.args)}k=[]};else{var d=function(a,b){var f=a.addEventListener;a.addEventListener=function(d,g,i){d=d+"";d.toLowerCase()===b.toLowerCase()?g===void 0||(g===null||Object.prototype.toString.call(g)!=="[object Function]")||(j?g.call(c):m[b.toLowerCase()].push(g)):f.call(a,d,g,i)};a.__defineSetter__("on"+b.toLowerCase(),function(c){a.addEventListener(b.toLowerCase(),c,false)})},q=function(a,c,b){for(var a=a.toLowerCase(),
b=new o(a,b||{}),d=0,g=m[a].length;d<g;d++)m[a][d].call(c,b)},m={isready:[],readystatechange:[],domcontentloaded:[],load:[]},C=!1,u=!1;c.document.addEventListener("DOMContentLoaded",function e(){C=true;c.document.removeEventListener("DOMContentLoaded",e,true)},!0);c.addEventListener("load",function f(){u=true;c.removeEventListener("load",f,true)},!0);c.document.addEventListener("readystatechange",function(b){b.stopImmediatePropagation();b.stopPropagation();c.document.readyState!=="interactive"&&c.document.readyState!==
"complete"?q("readystatechange",c.document):c.document.readyState="loading"},!0);var D="uninitialized";c.document.__defineSetter__("readyState",function(c){D=c});c.document.__defineGetter__("readyState",function(){return D});d(c,"load");d(c.document,"domcontentloaded");d(c,"domcontentloaded");d(c.document,"readystatechange");var F=(new Date).getTime()+3E3;(function h(){if((new Date).getTime()>=F){console.warn("opera.isReady check timed out");u=true}else for(var b in r)if(r[b]!==true){c.setTimeout(function(){h()},
20);return}c.setTimeout(function(){if(!j){for(var b=0,d=m.isready.length;b<d;b++)m.isready[b].call(c);m.isready=[];var g=(new Date).getTime()+3E3;(function G(){var b=(new Date).getTime();if(C||u||b>=g){c.document.readyState="interactive";q("readystatechange",c.document);q("domcontentloaded",c.document,{bubbles:true});b>=g&&console.warn("document.domcontentloaded event fired on check timeout");var d=(new Date).getTime()+3E3;(function H(){var b=(new Date).getTime();if(u||b>=d){c.document.readyState=
"complete";q("readystatechange",c.document);q("load",window);b>=d&&console.warn("window.load event fired on check timeout");for(var b=0,g=k.length;b<g;b++){var h=k[b];h.target[h.methodName].apply(h.target,h.args)}k=[]}else c.setTimeout(function(){H()},50)})()}else c.setTimeout(function(){G()},50)})();j=true}},0)})();i.isReady=function(b){j?b.call(c):m.isready.push(b)}}c.opera=i}(window);
opera.isReady(function(){function c(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");c=RegExp("[\\?&]"+c+"=([^&#]*)").exec(window.location.search);return null==c?"":window.decodeURIComponent(c[1].replace(/\+/g," "))}window.addEventListener("DOMContentLoaded",function(){var g=c("w"),d=c("h");document.body.style.minWidth=""!==g?g.replace(/\D/g,"")+"px":"300px";document.body.style.minHeight=""!==d?d.replace(/\D/g,"")+"px":"300px"},!1)});
opera.isReady(function(){document.addEventListener("DOMContentLoaded",function(){for(var c="load beforeunload unload click dblclick mouseover mousemove mousedown mouseup mouseout keydown keypress keyup blur focus".split(" "),g=0,d=c.length;g<d;g++)for(var i=document.querySelectorAll("[on"+c[g]+"]"),j=0,k=i.length;j<k;j++){var r=new Function("e",i[j].getAttribute("on"+c[g])),l=i[j];-1<c[g].indexOf("load")&&i[j]===document.body&&(l=window);i[j].removeAttribute("on"+c[g]);l.addEventListener(c[g],r,!0)}},
!1)});
