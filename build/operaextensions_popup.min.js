// operaextensions_popup.min.js - http://github.com/operasoftware/operaextensions.js
'use strict';!function(f){function x(a,c,d){j?a[c].apply(a,d):k.push({target:a,methodName:c,args:d})}var h=function(){};h.prototype.REVISION="1";h.prototype.version=function(){return this.REVISION};h.prototype.buildNumber=function(){return this.REVISION};h.prototype.postError=function(a){console.log(a)};var i=f.opera||new h,h=chrome.app.getDetails();navigator.browserLanguage=navigator.language;var j=!1,k=[],y={},m={},e="undefined"!==typeof window?window:{},e=e.MutationObserver||e.WebKitMutationObserver;
if("undefined"!==typeof process&&"[object process]"==={}.toString.call(process))e=function(a,c){process.nextTick(function(){a.call(c)})};else if(e){var u=[],e=new e(function(){var a=u.slice();u=[];a.forEach(function(a){a[0].call(a[1])})}),z=document.createElement("div");e.observe(z,{attributes:!0});e=function(a,c){u.push([a,c]);z.setAttribute("drainQueue","drainQueue")}}else e=function(a,c){setTimeout(function(){a.call(c)},1)};m.async=e;var F=m.Event=function(a,c){this.type=a;for(var d in c)c.hasOwnProperty(d)&&
(this[d]=c[d])},A=function(a,c){for(var d=0,b=a.length;d<b;d++)if(a[d][0]===c)return d;return-1},v=function(a){var c=a._promiseCallbacks;c||(c=a._promiseCallbacks={});return c},w=m.EventTarget={mixin:function(a){a.on=this.on;a.off=this.off;a.trigger=this.trigger;return a},on:function(a,c,d){for(var b=v(this),g,f,a=a.split(/\s+/),d=d||this;f=a.shift();)(g=b[f])||(g=b[f]=[]),-1===A(g,c)&&g.push([c,d])},off:function(a,c){for(var d=v(this),b,g,a=a.split(/\s+/);b=a.shift();)c?(b=d[b],g=A(b,c),-1!==g&&
b.splice(g,1)):d[b]=[]},trigger:function(a,c){var d,b,g,f;if(d=v(this)[a])for(var e=0,h=d.length;e<h;e++)b=d[e],g=b[0],b=b[1],"object"!==typeof c&&(c={detail:c}),f=new F(a,c),g.call(b,f)}},n=m.Promise=function(){this.on("promise:resolved",function(a){this.trigger("success",{detail:a.detail})},this);this.on("promise:failed",function(a){this.trigger("error",{detail:a.detail})},this)},B=function(){},C=function(a,c,d,b){var g,f;if(d)try{g=d(b.detail)}catch(e){f=e}else g=b.detail;if(g instanceof n)g.then(function(a){c.resolve(a)},
function(a){c.reject(a)});else if(d&&g)c.resolve(g);else if(f)c.reject(f);else c[a](g)};n.prototype={then:function(a,c){var d=new n;this.on("promise:resolved",function(c){C("resolve",d,a,c)});this.on("promise:failed",function(a){C("reject",d,c,a)});return d},resolve:function(a){m.async(function(){this.trigger("promise:resolved",{detail:a});this.isResolved=a},this);this.reject=this.resolve=B},reject:function(a){m.async(function(){this.trigger("promise:failed",{detail:a});this.isRejected=a},this);this.reject=
this.resolve=B}};w.mixin(n.prototype);var o=function(a,c){var d=document.createEvent("Event");d.initEvent(a,!0,!0);for(var b in c)d[b]=c[b];return d},e=function(){w.mixin(this)};e.prototype.constructor=e;e.prototype.addEventListener=function(a,c){this.on(a,c)};e.prototype.removeEventListener=function(a,c){this.off(a,c)};e.prototype.dispatchEvent=function(a){var c=a.type;if("function"===typeof this["on"+c.toLowerCase()])this.on(c,this["on"+c.toLowerCase()]);this.trigger(c,a)};Object.create(n.prototype);
for(var p in e.prototype);var r=function(a){w.mixin(this);this._isBackground=a||!1;this._localPort=null;this._isBackground||(this._localPort=chrome.extension.connect({name:""+Math.floor(1E16*Math.random())}),this._localPort.onDisconnect.addListener(function(){this.dispatchEvent(new o("disconnect",{source:this._localPort}));this._localPort=null}.bind(this)),a=function(a,d,b){var g=this._localPort;a&&a.action&&0===a.action.indexOf("___O_")?this.dispatchEvent(new o("controlmessage",{data:a,source:{postMessage:function(a){g.postMessage(a)},
tabId:d&&d.tab?d.tab.id:null}})):x(this,"dispatchEvent",[new o("message",{data:a,source:{postMessage:function(a){g.postMessage(a)},tabId:d&&d.tab?d.tab.id:null}})]);b&&b({})}.bind(this),this._localPort.onMessage.addListener(a),chrome.extension.onMessage.addListener(a),x(this,"dispatchEvent",[new o("connect",{source:this._localPort,origin:""})]))};r.prototype=Object.create(e.prototype);r.prototype.postMessage=function(a){this._isBackground?this.broadcastMessage(a):this._localPort&&this._localPort.postMessage(a)};
p=function(){r.call(this,!1)};p.prototype=Object.create(r.prototype);p.prototype.__defineGetter__("bgProcess",function(){return chrome.extension.getBackgroundPage()});var e=i.extension=i.extension||new p,s=i.contexts=i.contexts||{};p.prototype.getFile=function(a){var c=null;if("string"!=typeof a)return c;try{var d=chrome.extension.getURL("");0==a.indexOf("widget:")&&(a=a.replace("widget:","chrome-extension:"));0==a.indexOf("/")&&(a=a.substring(1));var a=(-1==a.indexOf(d)?d:"")+a,b=new XMLHttpRequest;
b.onloadend=function(){b.readyState==b.DONE&&200==b.status&&(result=b.response,result.name=a.substring(a.lastIndexOf("/")+1),result.lastModifiedDate=null,result.toString=function(){return"[object File]"},c=result)};b.open("GET",a,!1);b.responseType="blob";b.send(null)}catch(g){}return c};f.widget=f.widget||e.bgProcess.widget;h&&(h.permissions&&-1!=h.permissions.indexOf("tabs"))&&(e.windows=e.windows||e.bgProcess.opera.extension.windows);h&&(h.permissions&&-1!=h.permissions.indexOf("tabs"))&&(e.tabs=
e.tabs||e.bgProcess.opera.extension.tabs);h&&(h.permissions&&-1!=h.permissions.indexOf("tabs"))&&(e.tabGroups=e.tabGroups||e.bgProcess.opera.extension.tabGroups);h&&(void 0!==h.browser_action&&null!==h.browser_action)&&(s.toolbar=s.toolbar||e.bgProcess.opera.contexts.toolbar);h&&(h.permissions&&-1!=h.permissions.indexOf("contextMenus"))&&(f.MenuItem=e.bgProcess.MenuItem,f.MenuContext=e.bgProcess.MenuContext,s.menu=s.menu||e.bgProcess.opera.contexts.menu);if(f.opera)j=!0,i.isReady=function(a){a.call(i);
for(var a=0,c=k.length;a<c;a++){var d=k[a];d.target[d.methodName].apply(d.target,d.args)}k=[]};else{var h=function(a,c){var d=a.addEventListener;a.addEventListener=function(b,g,e){b=b+"";b.toLowerCase()===c.toLowerCase()?g===void 0||(g===null||Object.prototype.toString.call(g)!=="[object Function]")||(j?g.call(f):l[c.toLowerCase()].push(g)):d.call(a,b,g,e)};a.__defineSetter__("on"+c.toLowerCase(),function(d){a.addEventListener(c.toLowerCase(),d,false)})},q=function(a,c,d){for(var a=a.toLowerCase(),
d=new o(a,d||{}),b=0,g=l[a].length;b<g;b++)l[a][b].call(c,d)},l={isready:[],readystatechange:[],domcontentloaded:[],load:[]},D=!1,t=!1;f.document.addEventListener("DOMContentLoaded",function c(){D=true;f.document.removeEventListener("DOMContentLoaded",c,true)},!0);f.addEventListener("load",function d(){t=true;f.removeEventListener("load",d,true)},!0);f.document.addEventListener("readystatechange",function(d){d.stopImmediatePropagation();d.stopPropagation();f.document.readyState!=="interactive"&&f.document.readyState!==
"complete"?q("readystatechange",f.document):f.document.readyState="loading"},!0);var E="uninitialized";f.document.__defineSetter__("readyState",function(d){E=d});f.document.__defineGetter__("readyState",function(){return E});h(f,"load");h(f.document,"domcontentloaded");h(f,"domcontentloaded");h(f.document,"readystatechange");var G=(new Date).getTime()+3E3;(function b(){if((new Date).getTime()>=G){console.warn("opera.isReady check timed out");t=true}else for(var g in y)if(y[g]!==true){f.setTimeout(function(){b()},
20);return}f.setTimeout(function(){if(!j){for(var b=0,g=l.isready.length;b<g;b++)l.isready[b].call(f);l.isready=[];var e=(new Date).getTime()+3E3;(function H(){var b=(new Date).getTime();if(D||t||b>=e){f.document.readyState="interactive";q("readystatechange",f.document);q("domcontentloaded",f.document,{bubbles:true});b>=e&&console.warn("document.domcontentloaded event fired on check timeout");var g=(new Date).getTime()+3E3;(function I(){var b=(new Date).getTime();if(t||b>=g){f.document.readyState=
"complete";q("readystatechange",f.document);q("load",window);b>=g&&console.warn("window.load event fired on check timeout");for(var b=0,e=k.length;b<e;b++){var h=k[b];h.target[h.methodName].apply(h.target,h.args)}k=[]}else f.setTimeout(function(){I()},50)})()}else f.setTimeout(function(){H()},50)})();j=true}},0)})();i.isReady=function(b){j?b.call(f):l.isready.push(b)}}i.isReady(function(){function b(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");b=RegExp("[\\?&]"+b+"=([^&#]*)").exec(window.location.search);
return b==null?"":window.decodeURIComponent(b[1].replace(/\+/g," "))}window.addEventListener("DOMContentLoaded",function(){var g=b("w"),e=b("h");document.body.style.minWidth=g!==""?g.replace(/\D/g,"")+"px":"300px";document.body.style.minHeight=e!==""?e.replace(/\D/g,"")+"px":"300px"},false)});i.isReady(function(){document.addEventListener("DOMContentLoaded",function(){for(var b=["load","beforeunload","unload","click","dblclick","mouseover","mousemove","mousedown","mouseup","mouseout","keydown","keypress",
"keyup","blur","focus"],e=0,f=b.length;e<f;e++)for(var h=document.querySelectorAll("[on"+b[e]+"]"),i=0,k=h.length;i<k;i++){var l=new Function("e",h[i].getAttribute("on"+b[e])),j=h[i];b[e].indexOf("load")>-1&&h[i]===document.body&&(j=window);h[i].removeAttribute("on"+b[e]);j.addEventListener(b[e],l,true)}},false)});f.opera=i}(window);
