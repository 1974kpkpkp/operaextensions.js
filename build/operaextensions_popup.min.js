// operaextensions_popup.min.js - http://github.com/operasoftware/operaextensions.js
'use strict';!function(f){function L(a,b,c){v?a[b].apply(a,c):s.push({target:a,methodName:b,args:c})}function C(a,b){function c(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a}function e(a){a=parseInt(a,10);a=a.toString(16);return 0==a?"00":a}if(void 0===a||null===a)return a;"[object Array]"===Object.prototype.toString.call(a)&&(a=4===a.length?"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")":3===a.length?"rgb("+a[0]+","+a[1]+","+a[2]+")":"rgb(255,255,255)");var a=
a+"",d={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],
darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,
144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,
216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,
170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,
232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,
128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}[a.toLowerCase()];if(d)return"#"+e(d[0])+e(d[1])+e(d[2]);var d={hexLong:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hexShort:/^#([0-9a-fA-F]{3})$/},i;for(i in d)if(a.match(d[i]))return a;
i=[["rgb",/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/],["rgb",/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d+(?:\.\d+)?|\.\d+)\s*\)$/],["hsl",/^hsl\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/],["hsl",/^hsla\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%,\s*(\d+(?:\.\d+)?|\.\d+)\s*\)$/],["hsv",/^hsv\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/]];for(var d={rgb:function(a){return[a[1],a[2],a[3],a[4]||1]},hsl:function(a){var b=parseInt(a[1],10)%360/360,e=parseInt(a[2],10)%101/100,d=parseInt(a[3],10)%101/
100,a=a[4]||1;if(0===e)return[d,d,d];e=0.5>d?d*(1+e):d+e-d*e;d=2*d-e;return[(256*c(d,e,b+1/3)).toFixed(0),(256*c(d,e,b)).toFixed(0),(256*c(d,e,b-1/3)).toFixed(0),a]},hsv:function(a){var b,c,e,d=parseInt(a[1],10)%360/360,f=parseInt(a[2],10)%101/100,a=parseInt(a[3],10)%101/100,i=Math.floor(6*d),g=6*d-i,d=a*(1-f),h=a*(1-g*f),f=a*(1-(1-g)*f);switch(i%6){case 0:b=a;c=f;e=d;break;case 1:b=h;c=a;e=d;break;case 2:b=d;c=a;e=f;break;case 3:b=d;c=h;e=a;break;case 4:b=f;c=d;e=a;break;case 5:b=a,c=d,e=h}return[256*
b,256*c,256*e]}},f=0,g=i.length;f<g;f++){var h=i[f][1].exec(a);if(h)return i=d[i[f][0]](h),d=parseFloat(i[3]||1),i="NaN"===d+""||0>d||1<=d?i:0==d?[255,255,255]:[d*parseInt(i[0],10)+(1-d)*(b||255),d*parseInt(i[1],10)+(1-d)*(b||255),d*parseInt(i[2],10)+(1-d)*(b||255)],"#"+e(i[0]||255)+e(i[1]||255)+e(i[2]||255)}return"#f00"}var g=function(){};g.prototype.REVISION="1";g.prototype.version=function(){return this.REVISION};g.prototype.buildNumber=function(){return this.REVISION};g.prototype.postError=function(a){console.log(a)};
var q=f.opera||new g,D=chrome.app.getDetails(),v=!1,s=[],y={WIDGET_API_LOADED:!1,WIDGET_PREFERENCES_LOADED:!1,TOOLBAR_CONTEXT_LOADED:!1},w={},g="undefined"!==typeof window?window:{},g=g.MutationObserver||g.WebKitMutationObserver;if("undefined"!==typeof process&&"[object process]"==={}.toString.call(process))g=function(a,b){process.nextTick(function(){a.call(b)})};else if(g){var H=[],g=new g(function(){var a=H.slice();H=[];a.forEach(function(a){a[0].call(a[1])})}),M=document.createElement("div");g.observe(M,
{attributes:!0});g=function(a,b){H.push([a,b]);M.setAttribute("drainQueue","drainQueue")}}else g=function(a,b){setTimeout(function(){a.call(b)},1)};w.async=g;var V=w.Event=function(a,b){this.type=a;for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])},N=function(a,b){for(var c=0,e=a.length;c<e;c++)if(a[c][0]===b)return c;return-1},I=function(a){var b=a._promiseCallbacks;b||(b=a._promiseCallbacks={});return b},z=w.EventTarget={mixin:function(a){a.on=this.on;a.off=this.off;a.trigger=this.trigger;return a},
on:function(a,b,c){for(var e=I(this),d,f,a=a.split(/\s+/),c=c||this;f=a.shift();)(d=e[f])||(d=e[f]=[]),-1===N(d,b)&&d.push([b,c])},off:function(a,b){for(var c=I(this),e,d,a=a.split(/\s+/);e=a.shift();)b?(e=c[e],d=N(e,b),-1!==d&&e.splice(d,1)):c[e]=[]},trigger:function(a,b){var c,e,d,f;if(c=I(this)[a])for(var g=0,h=c.length;g<h;g++)e=c[g],d=e[0],e=e[1],"object"!==typeof b&&(b={detail:b}),f=new V(a,b),d.call(e,f)}},n=w.Promise=function(){this.on("promise:resolved",function(a){this.trigger("success",
{detail:a.detail})},this);this.on("promise:failed",function(a){this.trigger("error",{detail:a.detail})},this)},O=function(){},P=function(a,b,c,e){var d,f;if(c)try{d=c(e.detail)}catch(g){f=g}else d=e.detail;if(d instanceof n)d.then(function(a){b.resolve(a)},function(a){b.reject(a)});else if(c&&d)b.resolve(d);else if(f)b.reject(f);else b[a](d)};n.prototype={then:function(a,b){var c=new n;this.on("promise:resolved",function(b){P("resolve",c,a,b)});this.on("promise:failed",function(a){P("reject",c,b,
a)});return c},resolve:function(a){w.async(function(){this.trigger("promise:resolved",{detail:a});this.isResolved=a},this);this.reject=this.resolve=O},reject:function(a){w.async(function(){this.trigger("promise:failed",{detail:a});this.isRejected=a},this);this.reject=this.resolve=O}};z.mixin(n.prototype);var o=function(a,b){var c=document.createEvent("Event");c.initEvent(a,!0,!0);for(var e in b)c[e]=b[e];return c},g=function(){z.mixin(this)};g.prototype.constructor=g;g.prototype.addEventListener=
function(a,b){this.on(a,b)};g.prototype.removeEventListener=function(a,b){this.off(a,b)};g.prototype.dispatchEvent=function(a){var b=a.type;if("function"===typeof this["on"+b.toLowerCase()])this.on(b,this["on"+b.toLowerCase()]);this.trigger(b,a)};var A=function(){n.call(this)};A.prototype=Object.create(n.prototype);for(var m in g.prototype)A.prototype[m]=g.prototype[m];var k,K=function(){E=!1;J()},J=function(){if(!E){E=!0;var a=Q.shift();if(void 0===a)E=!1;else if(a.obj.isResolved)a.fn.call(a.obj,
K);else if(a.ignoreResolve)a.fn.call(a.obj,K);else{var b=f.setTimeout(function(){console.warn("PromiseQueue deadlock broken with timeout.");console.log(a.obj);console.log(a.obj.isResolved);a.obj.trigger("promise:resolved")},W);a.obj.on("promise:resolved",function(){b&&f.clearTimeout(b);a.obj.isResolved=!0;a.fn.call(a.obj,K)})}}},Q=[],E=!1,W=1E3;k={enqueue:function(a,b,c){Q.push({obj:a,fn:b,ignoreResolve:c});J()},dequeue:function(){J()}};var F=function(a){z.mixin(this);this._isBackground=a||!1;this._localPort=
null;this._isBackground||(this._localPort=chrome.extension.connect({name:""+Math.floor(1E16*Math.random())}),this._localPort.onDisconnect.addListener(function(){this.dispatchEvent(new o("disconnect",{source:this._localPort}));this._localPort=null}.bind(this)),a=function(a,c,e){var d=this._localPort;a&&a.action&&0===a.action.indexOf("___O_")?this.dispatchEvent(new o("controlmessage",{data:a,source:{postMessage:function(a){d.postMessage(a)},tabId:c&&c.tab?c.tab.id:null}})):L(this,"dispatchEvent",[new o("message",
{data:a,source:{postMessage:function(a){d.postMessage(a)},tabId:c&&c.tab?c.tab.id:null}})]);e&&e({})}.bind(this),this._localPort.onMessage.addListener(a),chrome.extension.onMessage.addListener(a),L(this,"dispatchEvent",[new o("connect",{source:this._localPort})]))};F.prototype=Object.create(g.prototype);F.prototype.postMessage=function(a){this._isBackground?this.broadcastMessage(a):this._localPort&&this._localPort.postMessage(a)};var h=function(){F.call(this,!1)};h.prototype=Object.create(F.prototype);
h.prototype.__defineGetter__("bgProcess",function(){return chrome.extension.getBackgroundPage()});var r=q.extension=q.extension||new h;m=q.contexts=q.contexts||{};h.prototype.getFile=function(a){var b=null;if("string"!=typeof a)return b;try{var c=chrome.extension.getURL("");0==a.indexOf("widget:")&&(a=a.replace("widget:","chrome-extension:"));0==a.indexOf("/")&&(a=a.substring(1));var a=(-1==a.indexOf(c)?c:"")+a,e=new XMLHttpRequest;e.onloadend=function(){e.readyState==e.DONE&&200==e.status&&(result=
e.response,result.name=a.substring(a.lastIndexOf("/")+1),result.lastModifiedDate=null,result.toString=function(){return"[object File]"},b=result)};e.open("GET",a,!1);e.responseType="blob";e.send(null)}catch(d){}return b};var t=function(){Object.defineProperty(this,"length",{value:0,writable:!0});Object.defineProperty(t.prototype,"getItem",{value:function(a){a=this[a];return void 0===a?null:a}});Object.defineProperty(t.prototype,"key",{value:function(a){var b=0;for(a in this)if(this.hasOwnProperty(a)){if(b==
a)return a;b++}return null}});Object.defineProperty(t.prototype,"removeItem",{value:function(a,b){this.hasOwnProperty(a)&&(delete this[a],this.length--,b||r.postMessage({action:"___O_widgetPreferences_removeItem_REQUEST",data:{key:a}}))}});Object.defineProperty(t.prototype,"setItem",{value:function(a,b,c){this[a]||this.length++;this[a]=b;c||r.postMessage({action:"___O_widgetPreferences_setItem_REQUEST",data:{key:a,val:b}})}});Object.defineProperty(t.prototype,"clear",{value:function(a){for(var b in this)this.hasOwnProperty(b)&&
delete this[b];this.length=0;a||r.postMessage({action:"___O_widgetPreferences_clear_REQUEST"})}})};t.prototype=Object.create(Storage.prototype);h=function(){z.mixin(this);this.properties=D||{};this._preferences=new t;this._preferencesSet={};r.addEventListener("controlmessage",function(a){if(a.data&&a.data.action)switch(a.data.action){case "___O_widget_setup_RESPONSE":for(var b in a.data.attrs)this.properties[b]=a.data.attrs[b];y.WIDGET_API_LOADED=!0;if(a.data._prefs)for(b in a.data._prefs)this._preferences[b]=
a.data._prefs[b],this._preferences.length++;y.WIDGET_PREFERENCES_LOADED=!0;break;case "___O_widgetPreferences_setItem_RESPONSE":this._preferences.setItem(a.data.data.key,a.data.data.val,!0);break;case "___O_widgetPreferences_removeItem_RESPONSE":this._preferences.removeItem(a.data.data.key,!0);break;case "___O_widgetPreferences_clear_RESPONSE":this._preferences.clear(!0)}}.bind(this),!1);r.postMessage({action:"___O_widget_setup_REQUEST"});f.addEventListener("beforeunload",function(){},!1)};h.prototype=
Object.create(g.prototype);h.prototype.__defineGetter__("name",function(){return this.properties.name||""});h.prototype.__defineGetter__("shortName",function(){return this.properties.name?this.properties.name.short||"":""});h.prototype.__defineGetter__("id",function(){return this.properties.id||""});h.prototype.__defineGetter__("description",function(){return this.properties.description||""});h.prototype.__defineGetter__("author",function(){return this.properties.author||""});h.prototype.__defineGetter__("authorHref",
function(){return this.properties.author?this.properties.author.href||"":""});h.prototype.__defineGetter__("authorEmail",function(){return this.properties.author?this.properties.author.email||"":""});h.prototype.__defineGetter__("version",function(){return this.properties.version||""});h.prototype.__defineGetter__("preferences",function(){return this._preferences});f.widget=f.widget||new h;var x=function(a){z.mixin(this);this.isBackground=!!a;this.length=0;chrome.browserAction.onClicked.addListener(function(){this[0]&&
this[0].dispatchEvent(new o("click",{}));this.dispatchEvent(new o("click",{}))}.bind(this));this.isBackground&&r.addEventListener("controlmessage",function(a){if(a.data&&a.data.action&&"___O_setup_toolbar_context_REQUEST"==a.data.action)if(this[0]){var c=this[0].properties;c.badge=c.badge.properties;c.popup=c.popup.properties;a.source.postMessage({action:"___O_setup_toolbar_context_RESPONSE",data:{toolbarUIItem_obj:c}})}else a.source.postMessage({action:"___O_setup_toolbar_context_RESPONSE",data:{toolbarUIItem_obj:void 0}})}.bind(this),
!1)};x.prototype=Object.create(g.prototype);x.prototype.createItem=function(a){return new j(a)};x.prototype.addItem=function(a){a&&!(!a instanceof j)&&(this[0]=a,this.length=1,a.resolve(!0),a.apply(),a.badge.resolve(!0),a.badge.apply(),a.popup.resolve(!0),a.popup.apply())};x.prototype.removeItem=function(a){a&&!(!a instanceof j)&&(this[0]&&this[0]===a)&&(delete this[0],this.length=0,chrome.browserAction.disable(),a.dispatchEvent(new o("remove",{})),this.dispatchEvent(new o("remove",{})))};var l=function(a){n.call(this);
this.properties={};this.properties.textContent=a.textContent?""+a.textContent:a.textContent;this.properties.backgroundColor=C(a.backgroundColor);this.properties.color=C(a.color);this.properties.display="none"===String(a.display).toLowerCase()?"none":"block"};l.prototype=Object.create(A.prototype);l.prototype.apply=function(){chrome.browserAction.setBadgeBackgroundColor({color:this.backgroundColor||"#f00"});"block"===this.display?chrome.browserAction.setBadgeText({text:this.textContent||""}):chrome.browserAction.setBadgeText({text:""})};
l.prototype.__defineGetter__("textContent",function(){return this.properties.textContent});l.prototype.__defineSetter__("textContent",function(a){this.properties.textContent=""+a;"block"===this.properties.display&&k.enqueue(this,function(b){chrome.browserAction.setBadgeText({text:""+a});b()}.bind(this))});l.prototype.__defineGetter__("backgroundColor",function(){return this.properties.backgroundColor});l.prototype.__defineSetter__("backgroundColor",function(a){this.properties.backgroundColor=C(a);
k.enqueue(this,function(a){chrome.browserAction.setBadgeBackgroundColor({color:this.properties.backgroundColor});a()}.bind(this))});l.prototype.__defineGetter__("color",function(){return this.properties.color});l.prototype.__defineSetter__("color",function(a){this.properties.color=C(a)});l.prototype.__defineGetter__("display",function(){return this.properties.display});l.prototype.__defineSetter__("display",function(a){"none"===(""+a).toLowerCase()?(this.properties.display="none",k.enqueue(this,function(a){chrome.browserAction.setBadgeText({text:""});
a()}.bind(this))):(this.properties.display="block",k.enqueue(this,function(a){chrome.browserAction.setBadgeText({text:this.properties.textContent});a()}.bind(this)))});var p=function(a){n.call(this);this.properties={};this.properties.href=a.href||"";this.properties.width=a.width||300;this.properties.height=a.height||200;this.isExternalHref=!1;""!==this.properties.href&&this.properties.href.match(/^(https?:\/\/|data:)/)&&(this.isExternalHref=!0);this.applyHrefVal=function(){return this.isExternalHref===
true?"/oex_shim/popup_resourceloader.html?href="+f.btoa(this.properties.href)+"&w="+this.properties.width+"&h="+this.properties.height:this.properties.href}};p.prototype=Object.create(A.prototype);p.prototype.apply=function(){chrome.browserAction.setPopup({popup:this.applyHrefVal()})};p.prototype.__defineGetter__("href",function(){return this.properties.href});p.prototype.__defineSetter__("href",function(a){a+="";this.isExternalHref=a.match(/^(https?:\/\/|data:)/)?!0:!1;this.properties.href=a;k.enqueue(this,
function(a){chrome.browserAction.setPopup({popup:this.applyHrefVal()});a()}.bind(this))});p.prototype.__defineGetter__("width",function(){return this.properties.width});p.prototype.__defineSetter__("width",function(a){a=(a+"").replace(/\D/g,"");this.properties.width=""==a?300:a;k.enqueue(this,function(a){chrome.browserAction.setPopup({popup:this.applyHrefVal()});a()}.bind(this))});p.prototype.__defineGetter__("height",function(){return this.properties.height});p.prototype.__defineSetter__("height",
function(a){a=(a+"").replace(/\D/g,"");this.properties.height=""==a?200:a;k.enqueue(this,function(a){chrome.browserAction.setPopup({popup:this.applyHrefVal()});a()}.bind(this))});var j=function(a){n.call(this);this.properties={};this.properties.disabled=a.disabled||!1;this.properties.title=a.title||"";this.properties.icon=a.icon||"";this.properties.popup=new p(a.popup||{});this.properties.badge=new l(a.badge||{});a.onclick&&(this.onclick=a.onclick)};j.prototype=Object.create(A.prototype);j.prototype.apply=
function(){chrome.browserAction.setTitle({title:this.title});this.icon&&chrome.browserAction.setIcon({path:this.icon});!0===this.disabled?chrome.browserAction.disable():chrome.browserAction.enable()};j.prototype.__defineGetter__("disabled",function(){return this.properties.disabled});j.prototype.__defineSetter__("disabled",function(a){this.properties.disabled!==a&&(!0===a||"true"===a||1===a||"1"===a?(this.properties.disabled=!0,k.enqueue(this,function(a){chrome.browserAction.disable();a()}.bind(this))):
(this.properties.disabled=!1,k.enqueue(this,function(a){chrome.browserAction.enable();a()}.bind(this))))});j.prototype.__defineGetter__("title",function(){return this.properties.title});j.prototype.__defineSetter__("title",function(a){this.properties.title=""+a;k.enqueue(this,function(a){chrome.browserAction.setTitle({title:this.title});a()}.bind(this))});j.prototype.__defineGetter__("icon",function(){return this.properties.icon});j.prototype.__defineSetter__("icon",function(a){this.properties.icon=
""+a;k.enqueue(this,function(a){chrome.browserAction.setIcon({path:this.icon});a()}.bind(this))});j.prototype.__defineGetter__("popup",function(){return this.properties.popup});j.prototype.__defineGetter__("badge",function(){return this.properties.badge});g=function(){x.call(this,!1);r.addEventListener("controlmessage",function(a){a.data&&a.data.action&&"___O_setup_toolbar_context_RESPONSE"==a.data.action&&(void 0!==a.data.data.toolbarUIItem_obj&&null!==a.data.data.toolbarUIItem_obj&&(this[0]=new j(a.data.data.toolbarUIItem_obj),
this.length=1),y.TOOLBAR_CONTEXT_LOADED=!0)}.bind(this),!1);r.postMessage({action:"___O_setup_toolbar_context_REQUEST",data:{}})};g.prototype=Object.create(x.prototype);D&&(void 0!==D.browser_action&&null!==D.browser_action)&&(m.toolbar=m.toolbar||new g);if(f.opera)v=!0,q.isReady=function(a){a.call(q);for(var a=0,b=s.length;a<b;a++){var c=s[a];c.target[c.methodName].apply(c.target,c.args)}s=[]};else{m=function(a,b){var c=a.addEventListener;a.addEventListener=function(e,d,g){e=e+"";e.toLowerCase()===
b.toLowerCase()?d===void 0||(d===null||Object.prototype.toString.call(d)!=="[object Function]")||(v?d.call(f):u[b.toLowerCase()].push(d)):c.call(a,e,d,g)};a.__defineSetter__("on"+b.toLowerCase(),function(c){a.addEventListener(b.toLowerCase(),c,false)})};var B=function(a,b,c){for(var a=a.toLowerCase(),c=new o(a,c||{}),e=0,d=u[a].length;e<d;e++)u[a][e].call(b,c)},u={isready:[],readystatechange:[],domcontentloaded:[],load:[]},R=!1,G=!1;f.document.addEventListener("DOMContentLoaded",function b(){R=true;
f.document.removeEventListener("DOMContentLoaded",b,true)},!0);f.addEventListener("load",function c(){G=true;f.removeEventListener("load",c,true)},!0);f.document.addEventListener("readystatechange",function(c){c.stopImmediatePropagation();c.stopPropagation();f.document.readyState!=="interactive"&&f.document.readyState!=="complete"?B("readystatechange",f.document):f.document.readyState="loading"},!0);var S="uninitialized";f.document.__defineSetter__("readyState",function(c){S=c});f.document.__defineGetter__("readyState",
function(){return S});m(f,"load");m(f.document,"domcontentloaded");m(f,"domcontentloaded");m(f.document,"readystatechange");var X=(new Date).getTime()+3E3;(function e(){if((new Date).getTime()>=X){console.warn("opera.isReady check timed out");G=true}else for(var d in y)if(y[d]!==true){f.setTimeout(function(){e()},20);return}f.setTimeout(function(){if(!v){for(var d=0,e=u.isready.length;d<e;d++)u.isready[d].call(f);u.isready=[];var g=(new Date).getTime()+3E3;(function T(){var d=(new Date).getTime();
if(R||G||d>=g){f.document.readyState="interactive";B("readystatechange",f.document);B("domcontentloaded",f.document,{bubbles:true});d>=g&&console.warn("document.domcontentloaded event fired on check timeout");var e=(new Date).getTime()+3E3;(function U(){var d=(new Date).getTime();if(G||d>=e){f.document.readyState="complete";B("readystatechange",f.document);B("load",window);d>=e&&console.warn("window.load event fired on check timeout");for(var d=0,g=s.length;d<g;d++){var h=s[d];h.target[h.methodName].apply(h.target,
h.args)}s=[]}else f.setTimeout(function(){U()},50)})()}else f.setTimeout(function(){T()},50)})();v=true}},0)})();q.isReady=function(e){v?e.call(f):u.isready.push(e)}}f.opera=q}(window);
